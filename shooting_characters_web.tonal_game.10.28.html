<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>æ±‰å­—å¬éŸ³å°„å‡»ï¼ˆç½‘é¡µç‰ˆï¼šæ”¯æŒè‡ªå®šä¹‰è¯åº“ï¼‰</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  :root{color-scheme:dark;--body-bg:#0b1220;--text-color:#fff;--canvas-bg:#071129;--canvas-border:#0c61a1;--ui-bg:rgba(0,0,0,.28);--ui-shadow:0 8px 30px rgba(0,0,0,.6);--button-bg:#0c6;--button-color:#002;--button-hover-filter:brightness(1.08);--button-focus-ring:0 0 0 2px rgba(12,102,0,.4);--badge-bg:rgba(255,255,255,.07);--tone-button-bg:#133047;--tone-button-border:rgba(255,255,255,.12);--tone-button-color:#fff;--tone-button-hover-bg:#1c4670;--tone-button-active-bg:#1c5d99;--message-bg:rgba(0,0,0,.45);--overlay-bg:rgba(0,0,0,.55);--panel-bg:#0f1a33;--panel-border:#275;--panel-text:#cfe;--panel-link:#9fe;--menu-title:#fff;--badge-text-weight:600;}
  body.theme-light{color-scheme:light;--body-bg:#f6f7fb;--text-color:#111;--canvas-bg:#ffffff;--canvas-border:#8ab4f8;--ui-bg:rgba(0,0,0,.06);--ui-shadow:0 6px 24px rgba(15,35,75,.16);--button-bg:#1e80ff;--button-color:#fff;--button-hover-filter:brightness(.97);--button-focus-ring:0 0 0 2px rgba(30,128,255,.28);--badge-bg:rgba(0,0,0,.08);--tone-button-bg:#e8f0ff;--tone-button-border:rgba(30,80,160,.18);--tone-button-color:#0d1f33;--tone-button-hover-bg:#d6e4ff;--tone-button-active-bg:#c2d6ff;--message-bg:rgba(0,0,0,.65);--overlay-bg:rgba(255,255,255,.7);--panel-bg:#ffffff;--panel-border:#8ab4f8;--panel-text:#123;--panel-link:#1160c5;--menu-title:#0a1a33;--badge-text-weight:600;}
  html,body{height:100%;margin:0;background:var(--body-bg);color:var(--text-color);font-family:"Noto Sans SC","Microsoft YaHei",sans-serif;display:flex;flex-direction:column;align-items:center;padding:18px 14px;box-sizing:border-box;transition:background .3s,color .3s;}
  #game{display:block;margin:12px auto 0;background:var(--canvas-bg);border:6px solid var(--canvas-border);box-shadow:var(--ui-shadow);cursor:crosshair;max-width:100%;height:auto;transition:background .3s,border-color .3s,box-shadow .3s;}
  .ui{width:100%;max-width:1000px;display:flex;flex-wrap:wrap;gap:8px;justify-content:flex-start;align-items:center;background:var(--ui-bg);padding:10px 16px;border-radius:12px;box-sizing:border-box;transition:background .3s,box-shadow .3s;}
  button{padding:6px 12px;border-radius:6px;border:none;background:var(--button-bg);color:var(--button-color);cursor:pointer;font-size:15px;line-height:1.3;transition:filter .18s,background .18s,color .18s;}
  button:hover{filter:var(--button-hover-filter);}
  .ui button,.ui select{padding:5px 10px;font-size:14px;background:var(--button-bg);color:var(--button-color);border:none;border-radius:6px;cursor:pointer;}
  .ui button:hover,.ui select:focus{outline:none;box-shadow:var(--button-focus-ring);}
  .badge{display:inline-flex;align-items:center;gap:4px;padding:4px 8px;font-size:14px;background:var(--badge-bg);border-radius:6px;transition:background .3s,color .3s;}
  .badge span:last-child{font-weight:var(--badge-text-weight);}
  label.switch{display:inline-flex;align-items:center;gap:6px;user-select:none;font-size:14px;}
  .switch input{width:18px;height:18px;}
  .setting{display:flex;align-items:center;gap:6px;font-size:14px;}
  .game-wrapper{position:relative;width:100%;max-width:1000px;}
  .tone-controls{margin-top:12px;display:flex;gap:10px;flex-wrap:wrap;justify-content:center;width:100%;max-width:1000px;}
  .tone-controls[hidden]{display:none !important;}
  .tone-button{background:var(--tone-button-bg);color:var(--tone-button-color);border:1px solid var(--tone-button-border);border-radius:999px;padding:10px 14px;min-width:64px;display:flex;flex-direction:column;align-items:center;gap:4px;font-size:18px;cursor:pointer;transition:transform .12s ease,background .18s ease,box-shadow .18s ease,color .18s ease;}
  .tone-button .tone-symbol{font-size:24px;line-height:1;min-height:1em;letter-spacing:1px;}
  .tone-button .tone-label{font-size:12px;opacity:.75;line-height:1;}
  .tone-button:hover{background:var(--tone-button-hover-bg);box-shadow:0 6px 16px rgba(12,34,64,.35);}
  .tone-button:active,.tone-button.active{transform:scale(.95);background:var(--tone-button-active-bg);box-shadow:0 4px 12px rgba(12,34,64,.3);}
  .tone-button.neutral .tone-symbol{min-width:1.5em;}
  #message{position:absolute;left:50%;transform:translateX(-50%);top:12px;z-index:30;
           font-size:18px;padding:6px 12px;background:var(--message-bg);border-radius:8px;color:#fff;
           opacity:0;transition:opacity .18s;}
  #importPanel[hidden]{display:none !important;}
  #importPanel{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;
               background:var(--overlay-bg);z-index:50}
  #importBox{background:var(--panel-bg);border:1px solid var(--panel-border);padding:20px;border-radius:12px;width:min(90%,560px);color:var(--panel-text)}
  #importBox h2{margin:0 0 10px;font-size:20px;color:inherit}
  #importBox p{margin:6px 0;line-height:1.5;color:inherit}
  #importBox input[type=file]{margin:8px 0}
  #startMenu{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;z-index:60;background:var(--overlay-bg)}
  #menuBox{background:var(--panel-bg);border:1px solid var(--panel-border);padding:24px;border-radius:12px;text-align:center;width:300px;color:var(--panel-text);}
  #menuBox h2{margin:0 0 12px;color:var(--menu-title);}
  #menuBox button{margin-top:8px;width:200px;font-size:16px;}
  .cta-inline{display:grid;grid-template-columns:auto 1fr auto;align-items:center;gap:10px;width:100%;max-width:1000px;margin-bottom:10px;}
  .cta-inline .lang-toggle{justify-self:start;}
  .cta-inline .cta-button{justify-self:center;}
  .topbar-spacer{height:1px;}
  .cta-button{display:inline-flex;align-items:center;justify-content:center;padding:10px 14px;border-radius:12px;
    background:linear-gradient(135deg,#ff6f61,#ffd166);color:#1b1033;font-weight:800;box-shadow:0 0 18px rgba(255,111,97,.6);
    text-decoration:none;letter-spacing:0.2px;text-transform:uppercase;animation:pulseGlow 1.6s ease-in-out infinite;}
  .cta-button:hover{filter:brightness(1.05);}
  .lang-toggle{display:flex;gap:6px;}
  .lang-toggle button{padding:4px 8px;font-size:12px;border-radius:999px;background:var(--badge-bg);color:var(--text-color);
    border:1px solid rgba(255,255,255,.18);box-shadow:none;}
  .lang-toggle button.active{background:#4ef0a5;color:#002;font-weight:700;}
  @keyframes pulseGlow{0%{box-shadow:0 0 12px rgba(255,111,97,.55);}50%{box-shadow:0 0 24px rgba(255,209,102,.85);}100%{box-shadow:0 0 12px rgba(255,111,97,.55);}}
  #lives{color:#ff4d6d;font-weight:700;}
</style>
</head>
<body class="theme-dark">
  <div class="cta-inline">
    <div class="lang-toggle">
      <button type="button" data-lang="zh" class="active">ä¸­æ–‡</button>
      <button type="button" data-lang="en">English</button>
    </div>
    <a id="bookBtn" class="cta-button" href="https://calendly.com/patrickct" target="_blank" rel="noopener">é¢„çº¦ Patrick è¯¾ç¨‹</a>
    <div class="topbar-spacer"></div>
  </div>

  <div class="ui">
    <button id="startBtn" title="å¼€å§‹æ–°çš„ä¸€å±€" data-i18n="restart">Restart</button>
    <button id="pauseBtn" title="æš‚åœæˆ–ç»§ç»­å½“å‰æ¸¸æˆ" data-i18n="pause">Pause</button>
    <button id="menuBtn" title="è¿”å›æ¨¡å¼é€‰æ‹©å¹¶é‡æ–°å¼€å§‹" data-i18n="menu">æ¨¡å¼èœå•</button>
    <span class="badge"><span data-i18n="scoreLabel">Score:</span>&nbsp;<span id="score">0</span></span>
    <span class="badge"><span data-i18n="comboLabel">Combo:</span>&nbsp;<span id="combo">0</span></span>
    <span class="badge"><span data-i18n="roundLabel">Round:</span>&nbsp;<span id="round">1</span></span>
    <span class="badge"><span data-i18n="timerLabel">Timer:</span>&nbsp;<span id="timer">00:00</span></span>
    <span class="badge"><span data-i18n="livesLabel">Lives:</span>&nbsp;<span id="lives">â™¥â™¥â™¥â™¥â™¥</span></span>
    <button id="replayBtn" title="é‡æ’­å½“å‰é¢˜ç›® (R)" data-i18n="replay">é‡æ’­ (R)</button>
    <label class="switch" data-i18n-wrapper="pinyin"><input type="checkbox" id="pinyinToggle" /> <span data-i18n="pinyin">æ˜¾ç¤ºæ‹¼éŸ³</span></label>
    <label class="setting" data-i18n-wrapper="duration"><span data-i18n="duration">æ—¶é•¿</span>
      <select id="timerSelect">
        <option value="180" selected data-i18n="duration3">3 åˆ†é’Ÿ</option>
        <option value="300" data-i18n="duration5">5 åˆ†é’Ÿ</option>
        <option value="480" data-i18n="duration8">8 åˆ†é’Ÿ</option>
      </select>
    </label>
    <label class="setting" data-i18n-wrapper="speed"><span data-i18n="speed">é€Ÿåº¦</span>
      <select id="speedSelect">
        <option value="30" data-i18n="speed1">è¾ƒæ…¢</option>
        <option value="36" data-i18n="speed2">æ…¢é€Ÿ</option>
        <option value="48" selected data-i18n="speed3">æ ‡å‡†</option>
        <option value="60" data-i18n="speed4">å¿«é€Ÿ</option>
        <option value="72" data-i18n="speed5">å¾ˆå¿«</option>
        <option value="90" data-i18n="speed6">æé€Ÿ</option>
      </select>
    </label>
    <label class="setting" data-i18n-wrapper="mode"><span data-i18n="mode">æ¨¡å¼</span>
      <select id="modeSelect">
        <option value="shooting" selected data-i18n="modeShooting">å°„å‡»</option>
        <option value="tone" data-i18n="modeTone">å£°è°ƒ</option>
      </select>
    </label>
    <label class="setting" data-i18n-wrapper="theme"><span data-i18n="theme">ä¸»é¢˜</span>
      <select id="themeSelect">
        <option value="dark" selected data-i18n="themeDark">æ·±è‰²</option>
        <option value="light" data-i18n="themeLight">æµ…è‰²</option>
      </select>
    </label>
    <label class="setting" id="weaponSetting" data-i18n-wrapper="weapon"><span data-i18n="weapon">æ­¦å™¨</span>
      <select id="weaponSelect"></select>
    </label>
    <div class="cta-inline">
      <div class="lang-toggle">
        <button type="button" data-lang="zh" class="active">ä¸­æ–‡</button>
        <button type="button" data-lang="en">English</button>
      </div>
      <a id="bookBtn" class="cta-button" href="https://calendly.com/patrickct" target="_blank" rel="noopener">é¢„çº¦ Patrick è¯¾ç¨‹</a>
    </div>
  </div>

  <div class="game-wrapper">
    <canvas id="game" width="1000" height="600"></canvas>
    <div id="message"></div>
  </div>

  <div id="toneControls" class="tone-controls" hidden></div>

  <!-- å¯åŠ¨èœå• -->
  <div id="startMenu">
    <div id="menuBox">
      <h2 id="menuTitle">ğŸ® é€‰æ‹©æ¨¡å¼</h2>
      <button id="shootingStartBtn">å°„å‡»æ¨¡å¼</button><br>
      <button id="toneStartBtn">å£°è°ƒæ¨¡å¼</button><br>
      <button id="customVocabBtn" style="background:#07c;">Upload Vocabulary</button>
    </div>
  </div>

  <!-- è¯åº“ä¸Šä¼ é¢æ¿ -->
  <div id="importPanel" hidden>
    <div id="importBox">
      <h2>ä¸Šä¼ è‡ªå®šä¹‰è¯åº“</h2>
      <p>ä¸Šä¼ ä½ çš„ JSON è¯åº“æ–‡ä»¶ï¼ˆä¾‹å¦‚ <code>words.json</code>ï¼‰ï¼š</p>
      <input id="fileInput" type="file" accept=".json" />
      <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
        <button id="saveCacheBtn">ä¿å­˜åˆ°æµè§ˆå™¨ç¼“å­˜</button>
        <button id="useOnceBtn">ä»…æœ¬æ¬¡ä½¿ç”¨</button>
        <button id="closeBoxBtn" style="background:#333;color:#fff">å–æ¶ˆ</button>
      </div>
      <p style="margin-top:10px;color:var(--panel-link)">
        éŸ³é¢‘æ–‡ä»¶æ”¾åœ¨ <code>audio/</code> æ–‡ä»¶å¤¹ä¸‹ä¸ JSON åŒåçš„å­ç›®å½•ä¸­ï¼Œä¾‹å¦‚è¯åº“
        <code>words.json</code> çš„è¯­éŸ³æ”¾åœ¨ <code>audio/words/ni3.mp3</code>ã€‚æ—§ç‰ˆæ‰å¹³ç»“æ„ä»å¯å…¼å®¹ã€‚
        å‘½ä¸­/æ‰“å/æ‰“é”™éŸ³æ•ˆæ”¾åœ¨ <code>sfx/</code> æ–‡ä»¶å¤¹ä¸­ï¼ˆå¯é€‰ï¼‰ã€‚
      </p>
      <details style="margin-top:10px;color:var(--panel-link)">
        <summary>ğŸ¯ è‡ªå®šä¹‰æ­¦å™¨å›¾ç‰‡æŒ‡å—</summary>
        <p style="margin-top:6px">1. åœ¨æ¸¸æˆåŒçº§ç›®å½•ä¸‹åˆ›å»º <code>weapons/</code> æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸ºæ¯ç§æ­¦å™¨æ–°å»ºå­æ–‡ä»¶å¤¹ï¼ˆå¦‚ <code>weapons/paint/</code>ï¼‰ã€‚</p>
        <p>2. æ¨èä½¿ç”¨é€æ˜èƒŒæ™¯çš„ PNG æˆ– WebP å›¾ç‰‡ï¼Œæ–‡ä»¶åéšæ„ï¼Œåªéœ€åœ¨æ¸…å•ä¸­å¼•ç”¨å³å¯ã€‚</p>
        <p>3. åœ¨ <code>weapons/manifest.json</code> ä¸­åˆ—å‡ºæ­¦å™¨é…ç½®ï¼Œ<code>mode</code> æ”¯æŒ <code>hitscan</code>ï¼ˆç›´å°„ï¼‰æˆ– <code>lob</code>ï¼ˆæŠ›ç‰©çº¿ï¼‰ï¼Œä¾‹å¦‚ï¼š</p>
        <pre style="background:#030b1d;padding:10px;border-radius:8px;color:#cfe;white-space:pre-wrap">[
  {
    "id": "cat",
    "label": "çŒ«å’ªå‘å°„å™¨",
    "mode": "hitscan",
    "power": 1,
    "recoil": 0.28,
    "preview": "weapons/cat/weapon.png",
    "previewImageScale": 0.78,
    "splat": "weapons/cat/impact.png",
    "splatImageScale": 1.18,
    "firingSound": "weapons/cat/cat_firing.mp3",
    "impactSound": "weapons/cat/cat_splat.mp3"
  },
  {
    "id": "paint",
    "label": "é¢œæ–™ç‚¸å¼¹",
    "mode": "lob",
    "power": 3,
    "preview": "weapons/paint/weapon.png",
    "previewImageScale": 0.9,
    "projectile": "weapons/paint/projectile.png",
    "projectileImageScale": 1.1,
    "splat": "weapons/paint/splat.png",
    "splatImageScale": 1.0,
    "impactSound": "weapons/paint/splat.mp3"
  }
]</pre>
        <p>4. ä¿å­˜ååˆ·æ–°é¡µé¢å³å¯çœ‹åˆ°æ–°çš„æ­¦å™¨é€‰é¡¹ã€‚å¯ä»¥ç»§ç»­æ·»åŠ å¯¹è±¡æ‰©å……æ­¦å™¨æ•°é‡ã€‚</p>
        <p>5. æŠ›æ·ç±»æ­¦å™¨çš„å¼¹ä½“ä¼šæ²¿æŠ›ç‰©çº¿é€æ¸ç¼©å°ï¼Œèµ·å§‹å¤§å°ä¼šå‚ç…§æ­¦å™¨å±•ç¤ºå›¾ï¼Œå‘½ä¸­æ—¶æ¥è¿‘ <code>splat.png</code> çš„å¯è§†å°ºå¯¸ã€‚ç›´å°„æ­¦å™¨å¯é€‰å¡« <code>projectile.png</code> æ¥å±•ç¤ºå­å¼¹è½¨è¿¹ï¼Œä¹Ÿå¯ä»¥çœç•¥ã€‚å»ºè®®å‡†å¤‡è‡³å°‘ä¸å±•ç¤ºå›¾å®½åº¦ 1.2 å€ï¼ˆçº¦ 220px ä»¥ä¸Šï¼‰çš„æº…å°„å›¾ç‰‡ï¼Œä»¥ä¾¿å‘½ä¸­æ—¶è¦†ç›–æ›´æ˜æ˜¾ã€‚å¯ä»¥ä½¿ç”¨ <code>previewImageScale</code>ã€<code>projectileImageScale</code> ä¸ <code>splatImageScale</code> å¾®è°ƒä¸‰å¼ å›¾ç‰‡çš„æ¸²æŸ“å°ºå¯¸ã€‚</p>
        <p>6. ä½¿ç”¨ <code>power</code> å­—æ®µå®šä¹‰æ¯æ¬¡å‘½ä¸­çš„â€œå¨åŠ›å€¼â€ï¼ˆå¡«å†™æ­£æ•´æ•°ï¼‰ï¼Œé»˜è®¤æ˜¯ 1ï¼Œè¡¨ç¤ºä¸€æ¬¡åªæ‰£æ‰ä¸€ä¸ªæ±‰å­—ï¼ˆæˆ–æ‹¼å†™å•ä½ï¼‰ã€‚è®¾ç½®ä¸º 3 å°±èƒ½ä¸€æ¬¡å‰Šæ‰ 3 ç‚¹è€ä¹…ï¼Œé€‚åˆâ€œä¾¿ä¾¿â€ä¸€ç±»çš„å¤§èŒƒå›´æ­¦å™¨ã€‚</p>
        <p>7. éŸ³æ•ˆæŒ‰é˜¶æ®µæ‹†åˆ†ï¼šç›´å°„æ­¦å™¨ç‚¹å‡»æ—¶æ’­æ”¾ <code>firingSound</code>ï¼ˆæœªå¡«å†™æ—¶ä¼šå›é€€åˆ° <code>sfx/hit.mp3</code> ä¿è¯æœ‰åé¦ˆï¼‰ï¼Œå‘½ä¸­çš„ <code>impactSound</code> åªæœ‰åœ¨æ¸…å•é‡ŒæŒ‡å®šæ—¶æ‰ä¼šæ’­æ”¾ï¼Œç¼ºçœåˆ™ä¿æŒå®‰é™ï¼›æŠ›æ·æ­¦å™¨ä»åœ¨è½åœ°æ—¶æ’­æ”¾ <code>impactSound</code>ã€‚è‹¥æœªåœ¨æ¸…å•ä¸­å†™æ˜è·¯å¾„ï¼Œç¨‹åºä¼šè‡ªåŠ¨å°è¯•åŒåæ–‡ä»¶ï¼Œä¾‹å¦‚ <code>weapons/&lt;æ­¦å™¨ID&gt;/&lt;æ­¦å™¨ID&gt;_firing.mp3</code> ä¸ <code>weapons/&lt;æ­¦å™¨ID&gt;/&lt;æ­¦å™¨ID&gt;_splat.mp3</code>ã€‚</p>
        <p>8. ç›´å°„æ­¦å™¨å¯é€‰å¡« <code>recoil</code> æ•°å€¼æ¥æ§åˆ¶å‡†æ˜Ÿçš„åååŠ›å¹…åº¦ï¼Œæ•°å€¼è¶Šå¤§æŠ–åŠ¨è¶Šæ˜æ˜¾ã€‚</p>
      </details>
    </div>
  </div>
<script src="game-obf.js"></script>

</body>
</html>
