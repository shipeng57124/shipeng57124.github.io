const a0_0x2fc661=a0_0x4358;(function(_0x30ee59,_0x15e200){const _0x4f9fac=a0_0x4358,_0x54591f=_0x30ee59();while(!![]){try{const _0x3a9b8d=parseInt(_0x4f9fac(0x296))/0x1+parseInt(_0x4f9fac(0x187))/0x2+-parseInt(_0x4f9fac(0x160))/0x3+parseInt(_0x4f9fac(0x1b4))/0x4*(-parseInt(_0x4f9fac(0x185))/0x5)+parseInt(_0x4f9fac(0x27b))/0x6+-parseInt(_0x4f9fac(0x13c))/0x7*(parseInt(_0x4f9fac(0x1d5))/0x8)+parseInt(_0x4f9fac(0x1f0))/0x9;if(_0x3a9b8d===_0x15e200)break;else _0x54591f['push'](_0x54591f['shift']());}catch(_0xc172ce){_0x54591f['push'](_0x54591f['shift']());}}}(a0_0x30af,0x28d71));const TONES=[{'tone':0x1,'key':'1','colIndex':0x0,'color':'#ff4d4f','symbol':'¯','zh':'一声','en':a0_0x2fc661(0x26d)},{'tone':0x2,'key':'2','colIndex':0x1,'color':a0_0x2fc661(0x243),'symbol':'ˊ','zh':'二声','en':'2nd\x20tone'},{'tone':0x3,'key':'3','colIndex':0x2,'color':a0_0x2fc661(0x23e),'symbol':'ˇ','zh':'三声','en':a0_0x2fc661(0x15c)},{'tone':0x4,'key':'4','colIndex':0x3,'color':a0_0x2fc661(0x241),'symbol':'ˋ','zh':'四声','en':a0_0x2fc661(0x142)},{'tone':0x5,'key':'5','colIndex':0x4,'color':a0_0x2fc661(0x196),'symbol':'','zh':'轻声','en':a0_0x2fc661(0x1c7)}],COL_TONE_BY_INDEX=[0x1,0x2,0x3,0x4,0x5],MAX_ROWS=0xc,CHAR_TIMEOUT_MS=0x0,FALL_SPEED=0x2d,FALLING_COLOR='#111',FALLING_TEXT_COLOR='#f5f5f5',TEXTS={'zh':{'title':'声调方块','welcome':a0_0x2fc661(0x24d),'enter':a0_0x2fc661(0x133),'levelLabel':a0_0x2fc661(0x29a),'deckLabel':a0_0x2fc661(0x24b),'start':a0_0x2fc661(0x27c),'restart':'再来一次','pause':'暂停','resume':'继续','paused':'已暂停','showSetup':'显示设置','hideSetup':a0_0x2fc661(0x19c),'score':a0_0x2fc661(0x152),'combo':a0_0x2fc661(0x177),'time':a0_0x2fc661(0x24a),'ready':a0_0x2fc661(0x19e),'gameOver':'游戏结束！','gameClear':'字词用完，游戏结束！','current':a0_0x2fc661(0x158),'langBtn':a0_0x2fc661(0x20e),'recordsTitle':a0_0x2fc661(0x283),'modalTitle':a0_0x2fc661(0x188),'nameLabel':a0_0x2fc661(0x28e),'save':a0_0x2fc661(0x264),'close':'关闭'},'en':{'title':'Tone\x20Blocks','welcome':a0_0x2fc661(0x1ec),'enter':a0_0x2fc661(0x263),'levelLabel':a0_0x2fc661(0x1ef),'deckLabel':a0_0x2fc661(0x230),'start':'Start','restart':a0_0x2fc661(0x128),'pause':'Pause','resume':'Resume','paused':a0_0x2fc661(0x218),'showSetup':a0_0x2fc661(0x209),'hideSetup':a0_0x2fc661(0x1bf),'score':a0_0x2fc661(0x1c5),'combo':a0_0x2fc661(0x23b),'time':a0_0x2fc661(0x1c0),'ready':a0_0x2fc661(0x172),'gameOver':a0_0x2fc661(0x234),'gameClear':'All\x20words\x20used.\x20Game\x20finished.','current':a0_0x2fc661(0x150),'langBtn':'中文','recordsTitle':a0_0x2fc661(0x118),'modalTitle':a0_0x2fc661(0x18b),'nameLabel':'Your\x20name:','save':'Save','close':'Close'}},STORAGE_KEY='tone_tetris_records_v2',canvas=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x212)),ctx=canvas[a0_0x2fc661(0x21c)]('2d'),welcomePanel=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x1d6)),welcomeText=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x1cf)),setupToggle=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x1a2)),levelSelect=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x250)),deckSelect=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x1f9)),startBtn=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x1c4)),scoreSpan=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x1b1)),comboSpan=document[a0_0x2fc661(0x26e)]('combo'),timeSpan=document['getElementById'](a0_0x2fc661(0x178)),statusLabel=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x170)),currentTextLabel=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x136)),infoDiv=document[a0_0x2fc661(0x26e)]('info'),titleEl=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x11b)),levelLabelEl=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x15e)),deckLabelEl=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x143)),scoreLabelEl=document[a0_0x2fc661(0x26e)]('score-label'),comboLabelEl=document['getElementById']('combo-label'),timerLabelEl=document[a0_0x2fc661(0x20d)](a0_0x2fc661(0x219)),langBtn=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x138)),pauseBtn=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x1e7)),headerRestartBtn=document[a0_0x2fc661(0x26e)]('header-restart-btn'),toneButtonsDiv=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x288)),gameOverOverlay=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x222)),gameOverText=document['getElementById'](a0_0x2fc661(0x1eb)),restartBtn=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x1d8)),recordsTitleEl=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x1ff)),recordsListEl=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x270)),resultModal=document['getElementById'](a0_0x2fc661(0x26a)),modalTitleEl=document[a0_0x2fc661(0x26e)]('modal-title'),modalSummaryEl=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x236)),nameLabelEl=document['getElementById']('name-label'),playerNameInput=document[a0_0x2fc661(0x26e)](a0_0x2fc661(0x144)),saveResultBtn=document['getElementById'](a0_0x2fc661(0x21a)),closeResultBtn=document[a0_0x2fc661(0x26e)]('close-result-btn');let currentLang='zh';const gameState={'categories':new Map(),'decksById':new Map(),'currentCategory':null,'currentDeckId':null,'phraseQueue':[],'currentPhrase':null,'currentCharIndex':0x0,'awaitingInput':![],'gameOver':![],'paused':![],'score':0x0,'combo':0x0,'board':[[],[],[],[],[]],'fallingBlocks':[],'currentPhraseId':null,'audioObj':null,'startTime':null,'timerHandle':null,'lastElapsedSec':0x0,'elapsedBaseSec':0x0,'charTimeoutHandle':null,'lastNoInputColumnIdx':null,'lastFrameTime':null};function buildToneButtons(){const _0x5e83e5=a0_0x2fc661,_0x1c5533={'YJDrU':_0x5e83e5(0x1c6),'SIYiU':'tone-btn','NPCYE':function(_0x5d40c5,_0x2f4387){return _0x5d40c5===_0x2f4387;},'akCdo':_0x5e83e5(0x119),'xJIYo':'click'};toneButtonsDiv[_0x5e83e5(0x145)]='',TONES[_0x5e83e5(0x15b)](_0x3d09d2=>{const _0x123fc7=_0x5e83e5,_0x44f9bc=document[_0x123fc7(0x1d3)](_0x1c5533['YJDrU']);_0x44f9bc[_0x123fc7(0x1b6)]=_0x1c5533['SIYiU'],_0x44f9bc[_0x123fc7(0x1bb)][_0x123fc7(0x130)]=_0x3d09d2[_0x123fc7(0x23c)],_0x44f9bc['dataset'][_0x123fc7(0x258)]=String(_0x3d09d2[_0x123fc7(0x258)]);const _0x38b268=_0x1c5533[_0x123fc7(0x1f7)](_0x3d09d2['tone'],0x5)?_0x1c5533[_0x123fc7(0x15d)]:_0x3d09d2[_0x123fc7(0x220)]||_0x3d09d2[_0x123fc7(0x258)];_0x44f9bc[_0x123fc7(0x145)]=_0x123fc7(0x181)+_0x38b268+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22tone-name\x22>'+(_0x1c5533[_0x123fc7(0x1f7)](currentLang,'zh')?_0x3d09d2['zh']:_0x3d09d2['en'])+_0x123fc7(0x17a),_0x44f9bc[_0x123fc7(0x244)](_0x1c5533[_0x123fc7(0x27a)],()=>handleToneInput(_0x3d09d2[_0x123fc7(0x258)])),toneButtonsDiv[_0x123fc7(0x155)](_0x44f9bc);});}function updateSetupToggleLabel(){const _0x1b2183=a0_0x2fc661,_0x35427f=TEXTS[currentLang],_0x31665a=welcomePanel['style'][_0x1b2183(0x205)]===_0x1b2183(0x260);setupToggle[_0x1b2183(0x1b9)]=_0x31665a?_0x35427f[_0x1b2183(0x1b2)]:_0x35427f['hideSetup'];}function updateLanguageUI(){const _0x5f32e2=a0_0x2fc661,_0x5af01d={'MFuwb':_0x5f32e2(0x284),'mggiW':_0x5f32e2(0x27d),'PrCuQ':function(_0x21acc6){return _0x21acc6();},'qTBeB':function(_0x3bc580){return _0x3bc580();},'AmlXG':function(_0x4b37ee){return _0x4b37ee();}},_0x766fc5=TEXTS[currentLang];titleEl['textContent']=_0x766fc5['title'],welcomeText[_0x5f32e2(0x1b9)]=_0x766fc5['welcome'],levelLabelEl[_0x5f32e2(0x1b9)]=_0x766fc5[_0x5f32e2(0x20a)],deckLabelEl[_0x5f32e2(0x1b9)]=_0x766fc5[_0x5f32e2(0x12b)],startBtn[_0x5f32e2(0x1b9)]=_0x766fc5[_0x5f32e2(0x1b0)],document[_0x5f32e2(0x26e)](_0x5af01d['MFuwb'])[_0x5f32e2(0x135)][_0x5f32e2(0x1b9)]=_0x766fc5['score'],document[_0x5f32e2(0x26e)](_0x5af01d['mggiW'])[_0x5f32e2(0x135)][_0x5f32e2(0x1b9)]=_0x766fc5[_0x5f32e2(0x294)],timerLabelEl[_0x5f32e2(0x135)][_0x5f32e2(0x1b9)]=_0x766fc5[_0x5f32e2(0x178)],langBtn[_0x5f32e2(0x1b9)]=_0x766fc5[_0x5f32e2(0x171)],headerRestartBtn[_0x5f32e2(0x1b9)]=_0x766fc5[_0x5f32e2(0x1b5)],recordsTitleEl['textContent']=_0x766fc5[_0x5f32e2(0x147)],modalTitleEl[_0x5f32e2(0x1b9)]=_0x766fc5['modalTitle'],nameLabelEl[_0x5f32e2(0x1b9)]=_0x766fc5[_0x5f32e2(0x15a)],saveResultBtn[_0x5f32e2(0x1b9)]=_0x766fc5[_0x5f32e2(0x17e)],closeResultBtn[_0x5f32e2(0x1b9)]=_0x766fc5[_0x5f32e2(0x259)],restartBtn[_0x5f32e2(0x1b9)]=_0x766fc5[_0x5f32e2(0x1b5)],_0x5af01d[_0x5f32e2(0x1ab)](refreshPauseButtonText),gameOverText[_0x5f32e2(0x1b9)]=_0x766fc5[_0x5f32e2(0x265)],infoDiv[_0x5f32e2(0x1b9)]=_0x766fc5[_0x5f32e2(0x1f6)];if(gameState['paused'])statusLabel['textContent']=_0x766fc5[_0x5f32e2(0x117)];_0x5af01d['qTBeB'](buildToneButtons),renderRecords(),_0x5af01d[_0x5f32e2(0x257)](updateSetupToggleLabel);}langBtn[a0_0x2fc661(0x244)](a0_0x2fc661(0x267),()=>{const _0x1d2a49=a0_0x2fc661,_0x1deece={'ClVqX':function(_0x43cfd5,_0x88ebe8){return _0x43cfd5===_0x88ebe8;}};currentLang=_0x1deece[_0x1d2a49(0x165)](currentLang,'zh')?'en':'zh',updateLanguageUI();}),pauseBtn[a0_0x2fc661(0x244)](a0_0x2fc661(0x267),()=>{const _0x5e2808=a0_0x2fc661,_0x1e5869={'EAWeM':function(_0x4e18b1,_0x47aba3){return _0x4e18b1(_0x47aba3);}};if(pauseBtn[_0x5e2808(0x22d)])return;_0x1e5869[_0x5e2808(0x167)](setPauseState,!gameState[_0x5e2808(0x117)]);}),pauseBtn[a0_0x2fc661(0x244)](a0_0x2fc661(0x267),()=>{const _0x50d02e=a0_0x2fc661,_0x4baa25={'vlMuK':function(_0x857110,_0x37bb2c){return _0x857110(_0x37bb2c);}};if(pauseBtn[_0x50d02e(0x22d)])return;_0x4baa25['vlMuK'](setPauseState,!gameState['paused']);}),setupToggle[a0_0x2fc661(0x244)](a0_0x2fc661(0x267),()=>{const _0xa7a79b=a0_0x2fc661,_0x2ace19={'VRTTM':function(_0x4fd2f0,_0x5d0189){return _0x4fd2f0===_0x5d0189;},'MhdoU':_0xa7a79b(0x260),'jBLfJ':function(_0x373b33){return _0x373b33();}},_0x5e3a9f=_0x2ace19['VRTTM'](welcomePanel[_0xa7a79b(0x1bb)][_0xa7a79b(0x205)],_0x2ace19[_0xa7a79b(0x14c)]);welcomePanel[_0xa7a79b(0x1bb)][_0xa7a79b(0x205)]=_0x5e3a9f?_0xa7a79b(0x223):_0x2ace19[_0xa7a79b(0x14c)],_0x2ace19[_0xa7a79b(0x28c)](updateSetupToggleLabel);});async function loadJSON(_0xccd2b){const _0x334755=a0_0x2fc661,_0x297c58={'DwBAb':function(_0x302953,_0xb7e997){return _0x302953+_0xb7e997;},'sqEsX':_0x334755(0x237)},_0x43d954=await fetch(_0xccd2b);if(!_0x43d954['ok'])throw new Error(_0x297c58[_0x334755(0x279)](_0x297c58['DwBAb'](_0x297c58[_0x334755(0x279)](_0x297c58[_0x334755(0x11a)],_0xccd2b),':\x20'),_0x43d954[_0x334755(0x21f)]));return _0x43d954[_0x334755(0x298)]();}function extractToneSequenceFromId(_0x41acb3){const _0xf7bd19=a0_0x2fc661,_0x5479c0={'hyHza':function(_0x179662,_0x13f0a3,_0x321eb7){return _0x179662(_0x13f0a3,_0x321eb7);}},_0x4bb69f=_0x41acb3[_0xf7bd19(0x22e)]('_'),_0x2a8107=[];for(const _0x6b1ef6 of _0x4bb69f){const _0x10d0b9=_0x6b1ef6[_0xf7bd19(0x186)](/([1-5])$/);if(_0x10d0b9)_0x2a8107[_0xf7bd19(0x24c)](_0x5479c0[_0xf7bd19(0x23f)](parseInt,_0x10d0b9[0x1],0xa));else _0x2a8107[_0xf7bd19(0x24c)](0x5);}return _0x2a8107;}function buildCharsForEntry(_0x48de41){const _0x37729e=a0_0x2fc661,_0xe45f98={'zlBEE':function(_0x4aaf4e,_0x4a5dfe){return _0x4aaf4e(_0x4a5dfe);}},_0x1b71db=_0x48de41[_0x37729e(0x18c)],_0x51906f=_0xe45f98[_0x37729e(0x140)](extractToneSequenceFromId,_0x48de41['id']),_0x5a81a9=Math[_0x37729e(0x248)](_0x1b71db[_0x37729e(0x1de)],_0x51906f[_0x37729e(0x1de)]),_0x156287=[];for(let _0x420324=0x0;_0x420324<_0x5a81a9;_0x420324++){_0x156287[_0x37729e(0x24c)]({'char':_0x1b71db[_0x420324],'tone':_0x51906f[_0x420324]});}return _0x156287;}function deriveAudioUrl(_0x5f5352,_0x342598){const _0x4da89d=a0_0x2fc661,_0x2deb40={'oJJUc':function(_0x541dcb,_0x2982cb){return _0x541dcb+_0x2982cb;}},_0x1b40ac=_0x5f5352[_0x4da89d(0x1a0)](/\.json$/i,''),_0x15dfc2=_0x342598[_0x4da89d(0x22e)](/[\\/]/)[_0x4da89d(0x1dc)]();return _0x2deb40[_0x4da89d(0x21e)](_0x1b40ac+'/',_0x15dfc2);}async function loadAllDatasets(){const _0x34304c=a0_0x2fc661,_0x4979a7={'Rfvla':function(_0x134d90,_0x160cff,_0x1258a4){return _0x134d90(_0x160cff,_0x1258a4);},'FGAya':function(_0x5b4b0e,_0x5924e6){return _0x5b4b0e(_0x5924e6);},'GXtQU':_0x34304c(0x157),'NSKMY':function(_0x50c36b,_0x208cfe){return _0x50c36b+_0x208cfe;},'xHODL':_0x34304c(0x1fb),'rqTCp':function(_0x206aec,_0x564ee3){return _0x206aec>_0x564ee3;},'SSmfQ':function(_0x1240ce,_0x4a0ba3){return _0x1240ce(_0x4a0ba3);},'bXzVO':_0x34304c(0x1fd),'XjLpT':function(_0x1fd192,_0x20cda){return _0x1fd192+_0x20cda;}},_0x584256=await _0x4979a7['FGAya'](loadJSON,_0x4979a7[_0x34304c(0x13a)]),_0x48f003=_0x584256['datasets']||[],_0x270e54=new Map(),_0x28ecf2=new Map(),_0x546d61=[];for(const _0x4bde26 of _0x48f003){try{const _0x1d3975=_0x4bde26['split']('/')['pop'](),_0x4e1597=_0x1d3975[_0x34304c(0x186)](/^([a-zA-Z]+)(\d+)/);if(!_0x4e1597)continue;const _0x36290d=_0x4e1597[0x1],_0x3c511e=_0x4e1597[0x2],_0x40216c=_0x3c511e[0x0],_0x4d7907=_0x4979a7[_0x34304c(0x242)](_0x36290d,_0x40216c)['toUpperCase'](),_0x1feccd=_0x1d3975[_0x34304c(0x1a0)](/\.json$/i,''),_0x2b7f91=await _0x4979a7[_0x34304c(0x184)](loadJSON,_0x4bde26);_0x2b7f91[_0x34304c(0x15b)](_0x2d9e5d=>{const _0x2bc0eb=_0x34304c;_0x2d9e5d['audioUrl']=_0x4979a7['Rfvla'](deriveAudioUrl,_0x4bde26,_0x2d9e5d[_0x2bc0eb(0x1db)]||'');}),_0x28ecf2[_0x34304c(0x16a)](_0x1feccd,{'id':_0x1feccd,'category':_0x4d7907,'displayName':_0x1feccd[_0x34304c(0x1c8)](),'entries':_0x2b7f91});if(!_0x270e54[_0x34304c(0x11e)](_0x4d7907))_0x270e54['set'](_0x4d7907,[]);_0x270e54[_0x34304c(0x1a3)](_0x4d7907)[_0x34304c(0x24c)](_0x1feccd);}catch(_0x285061){console['warn'](_0x34304c(0x16b),_0x4bde26,_0x285061),_0x546d61['push'](_0x4bde26);}}for(const [_0x44c11a,_0xcd48b3]of _0x270e54[_0x34304c(0x193)]()){_0xcd48b3['sort']();}gameState[_0x34304c(0x13f)]=_0x270e54,gameState[_0x34304c(0x199)]=_0x28ecf2,levelSelect[_0x34304c(0x145)]='';const _0x34cb9a=Array['from'](_0x270e54[_0x34304c(0x233)]())[_0x34304c(0x276)]();for(const _0x1dc090 of _0x34cb9a){const _0x46916d=document[_0x34304c(0x1d3)](_0x4979a7[_0x34304c(0x163)]);_0x46916d[_0x34304c(0x1a4)]=_0x1dc090,_0x46916d[_0x34304c(0x1b9)]=_0x1dc090,levelSelect[_0x34304c(0x155)](_0x46916d);}_0x4979a7[_0x34304c(0x231)](_0x34cb9a[_0x34304c(0x1de)],0x0)&&(gameState[_0x34304c(0x1ba)]=_0x34cb9a[0x0],_0x4979a7[_0x34304c(0x1fa)](populateDeckSelectForCategory,gameState['currentCategory']));const _0x9304e5=TEXTS[currentLang];let _0x18a244=_0x34304c(0x1f2)+(_0x34cb9a[_0x34304c(0x1a9)](',\x20')||_0x4979a7['bXzVO']);_0x4979a7[_0x34304c(0x231)](_0x546d61[_0x34304c(0x1de)],0x0)&&(_0x18a244+=_0x4979a7['NSKMY'](_0x34304c(0x245),_0x546d61[_0x34304c(0x1a9)]('\x0a'))),infoDiv['textContent']=_0x4979a7[_0x34304c(0x27f)](_0x4979a7[_0x34304c(0x242)](_0x18a244,'\x0a\x0a'),_0x9304e5[_0x34304c(0x1f6)]);}function populateDeckSelectForCategory(_0x51c164){const _0x50e399=a0_0x2fc661,_0x595aaa={'nsSiz':_0x50e399(0x1fb)},_0x4808a5=gameState[_0x50e399(0x13f)][_0x50e399(0x1a3)](_0x51c164)||[];deckSelect['innerHTML']='',_0x4808a5[_0x50e399(0x15b)](_0xc5ad8f=>{const _0x17545d=_0x50e399,_0x336678=gameState[_0x17545d(0x199)][_0x17545d(0x1a3)](_0xc5ad8f);if(!_0x336678)return;const _0x57ac96=document[_0x17545d(0x1d3)](_0x595aaa[_0x17545d(0x25d)]);_0x57ac96[_0x17545d(0x1a4)]=_0x336678['id'],_0x57ac96[_0x17545d(0x1b9)]=_0x336678[_0x17545d(0x213)],deckSelect[_0x17545d(0x155)](_0x57ac96);}),gameState[_0x50e399(0x174)]=_0x4808a5[_0x50e399(0x1de)]?_0x4808a5[0x0]:null;}function startTimer(_0x125c23=!![]){const _0x123781=a0_0x2fc661,_0x136bea={'clMcm':function(_0x1936e,_0x48a3cc){return _0x1936e(_0x48a3cc);}};if(_0x125c23)gameState[_0x123781(0x232)]=0x0;gameState[_0x123781(0x116)]=performance[_0x123781(0x139)](),gameState[_0x123781(0x1ce)]=gameState[_0x123781(0x232)],gameState[_0x123781(0x117)]=![],gameState[_0x123781(0x148)]=null;if(gameState[_0x123781(0x262)])_0x136bea[_0x123781(0x235)](clearInterval,gameState[_0x123781(0x262)]);gameState['timerHandle']=setInterval(updateTime,0x64);}function updateTime(){const _0x4f7684=a0_0x2fc661,_0xd59853={'yRcpw':function(_0x3d00f6,_0x19aa7a){return _0x3d00f6+_0x19aa7a;},'hyczS':function(_0x11509a,_0xd19633){return _0x11509a/_0xd19633;},'VwivY':function(_0x550e4d,_0x509bed){return _0x550e4d-_0x509bed;}};if(!gameState[_0x4f7684(0x116)])return;const _0x5267a2=_0xd59853['yRcpw'](_0xd59853[_0x4f7684(0x16e)](_0xd59853[_0x4f7684(0x19d)](performance[_0x4f7684(0x139)](),gameState[_0x4f7684(0x116)]),0x3e8),gameState[_0x4f7684(0x232)]||0x0);gameState['lastElapsedSec']=_0x5267a2,timeSpan[_0x4f7684(0x1b9)]=_0x5267a2['toFixed'](0x1);}function pauseTimer(){const _0x3adcc0=a0_0x2fc661,_0x2f9566={'SAJgD':_0x3adcc0(0x1f8),'fqDBU':function(_0x1a5926){return _0x1a5926();},'tRADC':function(_0x1a1c88,_0x211476){return _0x1a1c88(_0x211476);}},_0x1e1a86=_0x2f9566[_0x3adcc0(0x123)][_0x3adcc0(0x22e)]('|');let _0x2667bc=0x0;while(!![]){switch(_0x1e1a86[_0x2667bc++]){case'0':if(!gameState[_0x3adcc0(0x116)])return;continue;case'1':_0x2f9566[_0x3adcc0(0x285)](updateTime);continue;case'2':gameState['startTime']=null;continue;case'3':gameState['elapsedBaseSec']=gameState['lastElapsedSec'];continue;case'4':gameState[_0x3adcc0(0x262)]&&(_0x2f9566[_0x3adcc0(0x292)](clearInterval,gameState[_0x3adcc0(0x262)]),gameState[_0x3adcc0(0x262)]=null);continue;}break;}}function resumeTimer(){const _0x1de7a7=a0_0x2fc661,_0x3c7c71={'FPfKU':function(_0x33c7ca,_0x284198,_0xd39409){return _0x33c7ca(_0x284198,_0xd39409);}};if(gameState[_0x1de7a7(0x265)]||gameState[_0x1de7a7(0x116)])return;gameState[_0x1de7a7(0x116)]=performance[_0x1de7a7(0x139)]();if(gameState[_0x1de7a7(0x262)])clearInterval(gameState[_0x1de7a7(0x262)]);gameState[_0x1de7a7(0x262)]=_0x3c7c71['FPfKU'](setInterval,updateTime,0x64);}function stopTimer(){const _0x1e8cb8=a0_0x2fc661,_0x5270b4={'BBsjw':function(_0x1e4a58){return _0x1e4a58();},'mSngq':function(_0x277650,_0x37baf1){return _0x277650(_0x37baf1);}};if(gameState[_0x1e8cb8(0x116)])_0x5270b4[_0x1e8cb8(0x19a)](updateTime);gameState['timerHandle']&&(_0x5270b4[_0x1e8cb8(0x183)](clearInterval,gameState[_0x1e8cb8(0x262)]),gameState[_0x1e8cb8(0x262)]=null),gameState[_0x1e8cb8(0x116)]=null,gameState[_0x1e8cb8(0x232)]=gameState[_0x1e8cb8(0x1ce)]||gameState[_0x1e8cb8(0x232)]||0x0;}function a0_0x4358(_0x36f811,_0x1e3413){_0x36f811=_0x36f811-0x115;const _0x30af2c=a0_0x30af();let _0x435824=_0x30af2c[_0x36f811];return _0x435824;}function refreshPauseButtonText(){const _0x3c0026=a0_0x2fc661,_0x4c3b4d={'shtPh':_0x3c0026(0x164),'MytEX':_0x3c0026(0x1f4)},_0x545348=TEXTS[currentLang];pauseBtn[_0x3c0026(0x1b9)]=gameState[_0x3c0026(0x117)]?_0x545348[_0x3c0026(0x26b)]:_0x545348['pause'],pauseBtn[_0x3c0026(0x1aa)](_0x4c3b4d[_0x3c0026(0x22b)],gameState[_0x3c0026(0x117)]?_0x3c0026(0x11d):_0x4c3b4d[_0x3c0026(0x173)]);}function setPauseState(_0x211583){const _0x3d7662=a0_0x2fc661,_0x1408d6={'fubxu':function(_0x1ac1a4){return _0x1ac1a4();},'DsvNx':function(_0x18ebe5){return _0x18ebe5();},'SVAey':function(_0x4a31d2){return _0x4a31d2();}};if(gameState[_0x3d7662(0x265)])return;if(_0x211583){if(gameState[_0x3d7662(0x117)])return;gameState['paused']=!![],_0x1408d6['fubxu'](pauseTimer),statusLabel[_0x3d7662(0x1b9)]=TEXTS[currentLang]['paused'];}else{if(!gameState['paused'])return;gameState[_0x3d7662(0x117)]=![],statusLabel[_0x3d7662(0x1b9)]='',_0x1408d6[_0x3d7662(0x1e4)](resumeTimer),gameState[_0x3d7662(0x148)]=null;}_0x1408d6[_0x3d7662(0x275)](refreshPauseButtonText);}function scheduleCharTimeout(){const _0x3fdc33=a0_0x2fc661,_0x4089eb={'Snzpr':function(_0x33549e){return _0x33549e();},'lsVlK':function(_0x30fd73,_0x1aa8d0,_0x1eec7b){return _0x30fd73(_0x1aa8d0,_0x1eec7b);}};clearTimeout(gameState['charTimeoutHandle']);if(CHAR_TIMEOUT_MS<=0x0)return;gameState['charTimeoutHandle']=_0x4089eb[_0x3fdc33(0x28a)](setTimeout,()=>{const _0x102bbe=_0x3fdc33;_0x4089eb[_0x102bbe(0x146)](handleNoInputTimeout);},CHAR_TIMEOUT_MS);}const SFX_FILES={'hit':a0_0x2fc661(0x12d),'miss':a0_0x2fc661(0x27e),'wrong':'sfx/wrong.mp3'};let sfxContext=null;const sfxCache={};function playBeep(_0x2c0f54=0x370,_0x334446=0.08){const _0xb6f175=a0_0x2fc661,_0x3c634c={'nzgCC':_0xb6f175(0x14b),'myhvD':_0xb6f175(0x13e)};try{if(!sfxContext)sfxContext=new(window[(_0xb6f175(0x14a))]||window[(_0xb6f175(0x238))])();const _0x4bdaaa=sfxContext,_0x5dfa84=_0x4bdaaa[_0xb6f175(0x293)](),_0x248016=_0x4bdaaa[_0xb6f175(0x1da)]();_0x5dfa84[_0xb6f175(0x1a7)]=_0x3c634c[_0xb6f175(0x1d2)],_0x5dfa84['frequency']['value']=_0x2c0f54,_0x248016['gain'][_0xb6f175(0x1a4)]=0.15,_0x5dfa84[_0xb6f175(0x15f)](_0x248016)[_0xb6f175(0x15f)](_0x4bdaaa[_0xb6f175(0x22a)]);const _0x560ed4=_0x4bdaaa[_0xb6f175(0x1ac)];_0x5dfa84['start'](_0x560ed4),_0x5dfa84[_0xb6f175(0x261)](_0x560ed4+_0x334446);}catch(_0x2afb5f){console[_0xb6f175(0x1e2)](_0x3c634c[_0xb6f175(0x17d)],_0x2afb5f);}}function preloadSfx(){const _0x281448=a0_0x2fc661,_0xb67868={'xtwcd':_0x281448(0x12f)};Object[_0x281448(0x193)](SFX_FILES)['forEach'](([_0x1f6c90,_0x343050])=>{const _0x1bb015=new Audio(_0x343050);_0x1bb015['preload']=_0xb67868['xtwcd'],sfxCache[_0x1f6c90]=_0x1bb015;});}function playSfx(_0x5e29f7,_0x37167d=0x294){const _0x3784b1=a0_0x2fc661,_0x57be54={'IkSJh':function(_0x2ad71c,_0x1a40f1){return _0x2ad71c(_0x1a40f1);},'HxADy':_0x3784b1(0x229)},_0xde8f6=sfxCache[_0x5e29f7];if(!_0xde8f6){_0x57be54[_0x3784b1(0x176)](playBeep,_0x37167d);return;}try{const _0x57c6e3=_0xde8f6[_0x3784b1(0x20c)]();_0x57c6e3[_0x3784b1(0x1ac)]=0x0,_0x57c6e3[_0x3784b1(0x169)]()['catch'](()=>playBeep(_0x37167d));}catch(_0x564ce1){console[_0x3784b1(0x1e2)](_0x57be54[_0x3784b1(0x266)],_0x564ce1),playBeep(_0x37167d);}}function clearCharTimeout(){const _0x43f0cc=a0_0x2fc661,_0x80e42b={'tXJTJ':function(_0x32f3de,_0x2bea3e){return _0x32f3de(_0x2bea3e);}};gameState[_0x43f0cc(0x255)]&&(_0x80e42b['tXJTJ'](clearTimeout,gameState[_0x43f0cc(0x255)]),gameState['charTimeoutHandle']=null);}function resetBoard(){const _0x2f2aa1=a0_0x2fc661;gameState[_0x2f2aa1(0x194)]=[[],[],[],[],[]],gameState['fallingBlocks']=[],gameState[_0x2f2aa1(0x295)]=null;}function hideGameOverOverlay(){const _0x2abf6d=a0_0x2fc661;gameOverOverlay[_0x2abf6d(0x1bb)][_0x2abf6d(0x205)]=_0x2abf6d(0x260);}function showGameOverOverlay(){const _0x4b3cac=a0_0x2fc661,_0xcaa694={'UhRXR':_0x4b3cac(0x202)};gameOverOverlay['style'][_0x4b3cac(0x205)]=_0xcaa694[_0x4b3cac(0x281)];}function setHeaderRestartEnabled(_0x55266e){const _0x58c77a=a0_0x2fc661;headerRestartBtn[_0x58c77a(0x22d)]=!_0x55266e;}function resetGameStateForCurrentDeck(){const _0x525679=a0_0x2fc661,_0x38fe88={'IwSXA':'0.0','GilvF':function(_0x2a5f83){return _0x2a5f83();},'eMneg':function(_0xc128e3){return _0xc128e3();},'uCbfk':function(_0x3aaf21){return _0x3aaf21();}},_0x2527b9=gameState[_0x525679(0x199)][_0x525679(0x1a3)](gameState['currentDeckId']);if(!_0x2527b9)return;const _0x3cb008=_0x2527b9[_0x525679(0x193)]||[],_0x2803cc=_0x3cb008[_0x525679(0x28b)]()[_0x525679(0x276)](()=>Math[_0x525679(0x141)]()-0.5);gameState['phraseQueue']=_0x2803cc,gameState[_0x525679(0x20b)]=null,gameState[_0x525679(0x1a6)]=0x0,gameState[_0x525679(0x1af)]=null,gameState[_0x525679(0x1b1)]=0x0,gameState[_0x525679(0x294)]=0x0,gameState[_0x525679(0x265)]=![],gameState['awaitingInput']=![],gameState[_0x525679(0x117)]=![],gameState['startTime']=null,gameState[_0x525679(0x1ce)]=0x0,gameState[_0x525679(0x232)]=0x0,timeSpan['textContent']=_0x38fe88[_0x525679(0x1c9)],resetBoard(),_0x38fe88[_0x525679(0x191)](clearCharTimeout),_0x38fe88['eMneg'](updateScoreUI),statusLabel['textContent']='',currentTextLabel[_0x525679(0x1b9)]='',_0x38fe88[_0x525679(0x299)](hideGameOverOverlay),pauseBtn[_0x525679(0x22d)]=!![],_0x38fe88[_0x525679(0x191)](refreshPauseButtonText);}function updateScoreUI(){const _0x11b23e=a0_0x2fc661;scoreSpan[_0x11b23e(0x1b9)]=gameState[_0x11b23e(0x1b1)],comboSpan[_0x11b23e(0x1b9)]=gameState[_0x11b23e(0x294)];}function playCurrentAudio(_0x53d648){const _0x5a9863=a0_0x2fc661,_0x4c83b0={'QgSvO':_0x5a9863(0x289),'ubmmC':_0x5a9863(0x12f),'peftW':'anonymous','jrJHM':_0x5a9863(0x169),'mpKxV':function(_0x52618f,_0x282071,_0x3187cb){return _0x52618f(_0x282071,_0x3187cb);}};if(gameState[_0x5a9863(0x23d)])gameState[_0x5a9863(0x23d)][_0x5a9863(0x122)]();if(!_0x53d648)return![];const _0x3ac9c5=_0x53d648[_0x5a9863(0x12e)]||_0x53d648[_0x5a9863(0x1db)];if(!_0x3ac9c5)return![];const _0xf4939a=new Audio(_0x3ac9c5);_0xf4939a[_0x5a9863(0x240)]=_0x4c83b0[_0x5a9863(0x166)],_0xf4939a[_0x5a9863(0x197)]=_0x4c83b0[_0x5a9863(0x239)],_0xf4939a[_0x5a9863(0x1ac)]=0x0,gameState[_0x5a9863(0x23d)]=_0xf4939a;let _0x5b2a92=![];const _0x3a1378=()=>{if(_0x5b2a92)return;_0x5b2a92=!![],scheduleCharTimeout();};return _0xf4939a[_0x5a9863(0x244)](_0x4c83b0[_0x5a9863(0x1fe)],_0x3a1378,{'once':!![]}),_0xf4939a[_0x5a9863(0x244)](_0x5a9863(0x13b),_0x3a1378,{'once':!![]}),_0xf4939a[_0x5a9863(0x169)]()['catch'](_0x5936ab=>{const _0x114190=_0x5a9863;console['warn'](_0x4c83b0[_0x114190(0x18a)],_0x5936ab),_0x3a1378();}),_0x4c83b0[_0x5a9863(0x137)](setTimeout,()=>_0x3a1378(),0x12c),!![];}function spawnPhraseBlocks(_0x1f1994){const _0x2bc8a9=a0_0x2fc661,_0x19f296={'kQyAL':function(_0x33dc49,_0x1475bd){return _0x33dc49/_0x1475bd;},'plyKw':function(_0xaf4b31,_0x447edb){return _0xaf4b31<_0x447edb;},'iMWLi':function(_0x86d037,_0x5a387a){return _0x86d037-_0x5a387a;},'IyfNO':function(_0x6ae8f6,_0x27fb07){return _0x6ae8f6+_0x27fb07;},'DXBzt':function(_0x2133d8,_0x181cd6){return _0x2133d8>=_0x181cd6;},'LxHlW':function(_0x299f96,_0x38d10e){return _0x299f96(_0x38d10e);},'Unwzu':_0x2bc8a9(0x22c),'OGsCf':function(_0x453a0b,_0x1af138){return _0x453a0b*_0x1af138;}},_0x3aacd5=_0x1f1994['chars'],_0x3c114c=Math['ceil'](_0x19f296[_0x2bc8a9(0x269)](_0x3aacd5[_0x2bc8a9(0x1de)],0x5)),_0x17dc33=gameState['board'][_0x2bc8a9(0x1a5)](_0x27b0b6=>_0x27b0b6[_0x2bc8a9(0x1de)]),_0x38e6c1=-_0x3c114c*_0x19f296[_0x2bc8a9(0x269)](canvas[_0x2bc8a9(0x228)],MAX_ROWS)-0x14;for(let _0x580690=0x0;_0x19f296[_0x2bc8a9(0x26f)](_0x580690,_0x3aacd5[_0x2bc8a9(0x1de)]);_0x580690++){const _0x1a7443=_0x580690%0x5,_0x579a59=Math[_0x2bc8a9(0x1dd)](_0x19f296['kQyAL'](_0x580690,0x5)),_0x4318cc=_0x19f296['iMWLi'](_0x3c114c-0x1,_0x579a59),_0x225ac5=_0x19f296[_0x2bc8a9(0x17f)](_0x17dc33[_0x1a7443],_0x4318cc);if(_0x19f296[_0x2bc8a9(0x18f)](_0x225ac5,MAX_ROWS)){_0x19f296['LxHlW'](finishGame,_0x19f296[_0x2bc8a9(0x253)]);return;}gameState[_0x2bc8a9(0x126)][_0x2bc8a9(0x24c)]({'char':_0x3aacd5[_0x580690]['char'],'trueTone':_0x3aacd5[_0x580690][_0x2bc8a9(0x258)],'colIdx':_0x1a7443,'targetRowIndex':_0x225ac5,'y':_0x19f296[_0x2bc8a9(0x17f)](_0x38e6c1,_0x19f296['OGsCf'](_0x579a59,_0x19f296[_0x2bc8a9(0x269)](canvas['height'],MAX_ROWS))),'phraseId':_0x1f1994['id'],'charIndex':_0x580690});}}function nextPhrase(){const _0x1b9f3f=a0_0x2fc661,_0x1bbff5={'WmQDH':function(_0x4849ba){return _0x4849ba();},'wcYPI':function(_0x2bde71,_0x412aa4){return _0x2bde71>_0x412aa4;},'BADcw':function(_0xcad34c,_0x18583a){return _0xcad34c===_0x18583a;},'MunLL':function(_0x403a72,_0xa0db41){return _0x403a72(_0xa0db41);},'FCcLY':function(_0x4752e9){return _0x4752e9();}};_0x1bbff5[_0x1b9f3f(0x1b7)](clearCharTimeout);if(gameState[_0x1b9f3f(0x265)])return;if(_0x1bbff5[_0x1b9f3f(0x14e)](gameState['fallingBlocks'][_0x1b9f3f(0x1de)],0x0)){setTimeout(nextPhrase,0x78);return;}if(_0x1bbff5[_0x1b9f3f(0x201)](gameState['phraseQueue'][_0x1b9f3f(0x1de)],0x0)){finishGame('clear');return;}const _0x526279=gameState['phraseQueue'][_0x1b9f3f(0x18d)](),_0xa442fd=_0x1bbff5[_0x1b9f3f(0x115)](buildCharsForEntry,_0x526279);if(_0xa442fd[_0x1b9f3f(0x1de)]===0x0)return _0x1bbff5[_0x1b9f3f(0x1bd)](nextPhrase);const _0x3835bc=Date[_0x1b9f3f(0x139)]()+'_'+Math['random']()[_0x1b9f3f(0x175)](0x10)['slice'](0x2);gameState['currentPhrase']={'entry':_0x526279,'chars':_0xa442fd,'answered':new Array(_0xa442fd[_0x1b9f3f(0x1de)])['fill'](![]),'id':_0x3835bc},gameState[_0x1b9f3f(0x1af)]=_0x3835bc,gameState[_0x1b9f3f(0x1a6)]=0x0,gameState[_0x1b9f3f(0x291)]=!![];const _0x4125f0=TEXTS[currentLang],_0x201ab8=_0xa442fd[0x0]?.[_0x1b9f3f(0x1d0)]||'';currentTextLabel[_0x1b9f3f(0x1b9)]=_0x4125f0[_0x1b9f3f(0x154)]+'\x20'+_0x526279[_0x1b9f3f(0x18c)]+_0x1b9f3f(0x1ee)+_0x201ab8,_0x1bbff5[_0x1b9f3f(0x115)](spawnPhraseBlocks,gameState[_0x1b9f3f(0x20b)]);const _0x356b5c=playCurrentAudio(_0x526279);!_0x356b5c&&_0x1bbff5[_0x1b9f3f(0x1bd)](scheduleCharTimeout);}function markCharAnswered(_0x5b31fa,_0x33f3c2){const _0xf1272f=a0_0x2fc661,_0x24ef41={'ilhhx':function(_0x1016b8,_0x2b950b){return _0x1016b8>=_0x2b950b;},'bwEry':function(_0x1e925e){return _0x1e925e();}},_0x8f9f3c=gameState[_0xf1272f(0x20b)];if(!_0x8f9f3c)return;if(_0x8f9f3c[_0xf1272f(0x25a)][_0x5b31fa])return;_0x8f9f3c['answered'][_0x5b31fa]=!![];const _0x4c3ac2=_0x8f9f3c['answered'][_0xf1272f(0x189)](_0x29f49f=>!_0x29f49f),_0x2244f2=TEXTS[currentLang];if(_0x24ef41[_0xf1272f(0x1ea)](_0x4c3ac2,0x0)){const _0x3668bd=_0x8f9f3c[_0xf1272f(0x1b8)][_0x4c3ac2]?.[_0xf1272f(0x1d0)]||'';currentTextLabel[_0xf1272f(0x1b9)]=_0x2244f2[_0xf1272f(0x154)]+'\x20'+_0x8f9f3c[_0xf1272f(0x1be)][_0xf1272f(0x18c)]+_0xf1272f(0x1ee)+_0x3668bd;}!_0x33f3c2&&(gameState['combo']=0x0,_0x24ef41[_0xf1272f(0x214)](updateScoreUI)),_0x24ef41[_0xf1272f(0x214)](tryFinishPhrase);}function tryFinishPhrase(){const _0x4f7ffd=a0_0x2fc661,_0x245c74={'hUjcI':function(_0x36d6c1){return _0x36d6c1();},'KlsUn':function(_0x5f1bcd,_0x12ae38){return _0x5f1bcd&&_0x12ae38;},'jsgoq':function(_0x427776,_0x3866e9,_0x31fe7a){return _0x427776(_0x3866e9,_0x31fe7a);}},_0x49e38c=gameState[_0x4f7ffd(0x20b)];if(!_0x49e38c)return;const _0x2ff346=_0x49e38c[_0x4f7ffd(0x25a)]['every'](Boolean),_0x20b06a=gameState['fallingBlocks'][_0x4f7ffd(0x16f)](_0x5908aa=>_0x5908aa[_0x4f7ffd(0x12c)]===_0x49e38c['id']);if(_0x245c74[_0x4f7ffd(0x200)](_0x2ff346,!_0x20b06a))gameState[_0x4f7ffd(0x291)]=![],gameState[_0x4f7ffd(0x20b)]=null,currentTextLabel['textContent']='',_0x245c74[_0x4f7ffd(0x1c1)](setTimeout,()=>{const _0x1b643f=_0x4f7ffd;if(!gameState[_0x1b643f(0x265)])_0x245c74['hUjcI'](nextPhrase);},0x78);else _0x2ff346&&(gameState[_0x4f7ffd(0x291)]=![]);}function handleToneInput(_0x3a88af){const _0xdce874=a0_0x2fc661,_0x2d4f23={'YHFTQ':function(_0x59374e,_0x445348){return _0x59374e===_0x445348;},'iVTtX':function(_0x16ad43){return _0x16ad43();},'GLbdL':function(_0x520402,_0x2917c7){return _0x520402===_0x2917c7;},'YyZED':function(_0xbf6451,_0x21d00d){return _0xbf6451>=_0x21d00d;},'vAjCH':function(_0x420496,_0x35c603,_0x217895){return _0x420496(_0x35c603,_0x217895);},'uJSxO':_0xdce874(0x132),'HSfxH':function(_0x35008c){return _0x35008c();},'arxhD':function(_0x8dc75a,_0x580ae1,_0x26e236){return _0x8dc75a(_0x580ae1,_0x26e236);},'STOKy':'wrong'};if(gameState['gameOver']||gameState[_0xdce874(0x117)]||!gameState['awaitingInput'])return;const _0x3027f6=gameState[_0xdce874(0x20b)];if(!_0x3027f6)return;const _0x175c16=_0x3027f6[_0xdce874(0x25a)]['findIndex'](_0x463e7f=>!_0x463e7f);if(_0x2d4f23['YHFTQ'](_0x175c16,-0x1))return;const _0x45c960=_0x3027f6[_0xdce874(0x1b8)][_0x175c16],_0x2e020a=_0x45c960[_0xdce874(0x258)];_0x2d4f23['iVTtX'](clearCharTimeout);if(_0x2d4f23[_0xdce874(0x1ed)](_0x3a88af,_0x2e020a)){gameState['score']+=0xa,gameState[_0xdce874(0x294)]+=0x1,updateScoreUI();const _0x74498f=gameState['fallingBlocks'][_0xdce874(0x189)](_0x3f22dc=>_0x3f22dc[_0xdce874(0x12c)]===_0x3027f6['id']&&_0x3f22dc[_0xdce874(0x1b3)]===_0x175c16);_0x2d4f23[_0xdce874(0x274)](_0x74498f,0x0)&&gameState[_0xdce874(0x126)][_0xdce874(0x1ae)](_0x74498f,0x1),_0x2d4f23[_0xdce874(0x1c3)](playSfx,_0x2d4f23['uJSxO'],0x4b0),_0x2d4f23['vAjCH'](markCharAnswered,_0x175c16,!![]);}else _0x2d4f23[_0xdce874(0x272)](updateScoreUI),_0x2d4f23[_0xdce874(0x206)](playSfx,_0x2d4f23[_0xdce874(0x16c)],0x140),markCharAnswered(_0x175c16,![]),settleWrongToneBlock(_0x3027f6['id'],_0x175c16,_0x3a88af,_0x45c960);}function handleNoInputTimeout(){}function spawnBlockFromError(_0x226678,_0xd4b8ef){const _0x4ebb7e=a0_0x2fc661,_0x2360d3={'EnCSl':function(_0xfef551,_0x3fb616,_0x12d806){return _0xfef551(_0x3fb616,_0x12d806);}},_0x209da2=TONES[_0x4ebb7e(0x278)](_0x23c6f5=>_0x23c6f5[_0x4ebb7e(0x258)]===_0x226678);if(!_0x209da2)return;_0x2360d3[_0x4ebb7e(0x28f)](spawnBlockAtColumn,_0xd4b8ef,_0x209da2['colIndex']);}function settleWrongToneBlock(_0x261177,_0x140f89,_0x2eb58f,_0x2dc304){const _0x5cdd28=a0_0x2fc661,_0x651e6={'UzfFf':function(_0x223cec,_0x50adde){return _0x223cec>=_0x50adde;},'AoGfk':function(_0x74d3c1,_0x4e1c2f){return _0x74d3c1-_0x4e1c2f;},'uvRtr':function(_0x5ddd66,_0x1e7364){return _0x5ddd66/_0x1e7364;},'iYDzR':function(_0x4d13df,_0xd3697b){return _0x4d13df(_0xd3697b);}},_0x469eb1=TONES[_0x5cdd28(0x278)](_0x189d0d=>_0x189d0d[_0x5cdd28(0x258)]===_0x2eb58f);if(!_0x469eb1)return;const _0x212010=gameState[_0x5cdd28(0x126)]['findIndex'](_0x5c6aa5=>_0x5c6aa5[_0x5cdd28(0x12c)]===_0x261177&&_0x5c6aa5[_0x5cdd28(0x1b3)]===_0x140f89);if(_0x651e6[_0x5cdd28(0x1e9)](_0x212010,0x0))gameState[_0x5cdd28(0x126)][_0x5cdd28(0x1ae)](_0x212010,0x1);const _0x3dc948=gameState[_0x5cdd28(0x194)][_0x469eb1[_0x5cdd28(0x216)]][_0x5cdd28(0x1de)],_0xfde739=gameState[_0x5cdd28(0x126)]['filter'](_0x4fb010=>_0x4fb010[_0x5cdd28(0x24f)]===_0x469eb1['colIndex'])[_0x5cdd28(0x1de)],_0x19e62a=_0x3dc948+_0xfde739,_0x11f199={'char':_0x2dc304[_0x5cdd28(0x1d0)],'trueTone':_0x2dc304['tone'],'colIdx':_0x469eb1[_0x5cdd28(0x216)],'targetRowIndex':_0x19e62a,'y':_0x651e6['AoGfk'](MAX_ROWS-0x1,_0x19e62a)*_0x651e6[_0x5cdd28(0x25e)](canvas[_0x5cdd28(0x228)],MAX_ROWS),'phraseId':_0x261177,'charIndex':_0x140f89};_0x651e6['iYDzR'](finalizeLanding,_0x11f199);}function spawnBlockAtColumn(_0x538f49,_0x21a837){const _0x28157f=a0_0x2fc661,_0x390725={'fFklU':function(_0x14b5c9,_0x20527c){return _0x14b5c9+_0x20527c;},'arIPs':function(_0x383d10,_0xeb480d){return _0x383d10>=_0xeb480d;}},_0x74f03c=gameState[_0x28157f(0x194)][_0x21a837][_0x28157f(0x1de)],_0x20efe4=gameState[_0x28157f(0x126)]['filter'](_0x157285=>_0x157285[_0x28157f(0x24f)]===_0x21a837)[_0x28157f(0x1de)],_0x378369=_0x390725['fFklU'](_0x74f03c,_0x20efe4);if(_0x390725['arIPs'](_0x378369,MAX_ROWS)){gameState[_0x28157f(0x126)]['push']({'char':_0x538f49[_0x28157f(0x1d0)],'trueTone':_0x538f49[_0x28157f(0x258)],'colIdx':_0x21a837,'targetRowIndex':_0x378369,'y':-0x32});return;}gameState['fallingBlocks'][_0x28157f(0x24c)]({'char':_0x538f49['char'],'trueTone':_0x538f49['tone'],'colIdx':_0x21a837,'targetRowIndex':_0x378369,'y':-0x32});}function finalizeLanding(_0xb1d11d){const _0x4ec333=a0_0x2fc661,_0x5126ed={'HjdSa':function(_0x492d5a,_0x2bd754){return _0x492d5a===_0x2bd754;},'qHNiD':function(_0x3983bb,_0x4b9c9c){return _0x3983bb&&_0x4b9c9c;},'LDmyi':'miss','UlFvv':function(_0x512eb7){return _0x512eb7();},'vSfXs':function(_0x3a0fdb,_0x37ffe2){return _0x3a0fdb>_0x37ffe2;},'NwVSJ':function(_0x4f3480,_0x422465){return _0x4f3480(_0x422465);},'FpfpL':'over'},_0x4be33c=_0xb1d11d[_0x4ec333(0x24f)],_0x3b050c=gameState[_0x4ec333(0x194)][_0x4be33c],_0x24821d=gameState[_0x4ec333(0x20b)]&&_0x5126ed[_0x4ec333(0x11c)](_0xb1d11d[_0x4ec333(0x12c)],gameState['currentPhrase']['id']),_0x482691=_0x24821d&&gameState[_0x4ec333(0x20b)][_0x4ec333(0x25a)][_0xb1d11d[_0x4ec333(0x1b3)]];if(_0x5126ed[_0x4ec333(0x1e0)](_0x24821d,!_0x482691)){playSfx(_0x5126ed['LDmyi'],0x1b8),markCharAnswered(_0xb1d11d['charIndex'],![]),applyPenaltyRows(0x1),_0x5126ed['UlFvv'](tryFinishPhrase);return;}_0x3b050c[_0x4ec333(0x24c)]({'char':_0xb1d11d['char'],'trueTone':_0xb1d11d[_0x4ec333(0x1e1)]});if(_0x5126ed['vSfXs'](_0x3b050c['length'],MAX_ROWS)){_0x5126ed[_0x4ec333(0x198)](finishGame,_0x5126ed[_0x4ec333(0x210)]);return;}checkColumnForClear(_0x4be33c),_0x5126ed[_0x4ec333(0x217)](tryFinishPhrase);}function applyPenaltyRows(_0xf8fd19){const _0x245cd3=a0_0x2fc661,_0x54438b={'bEfgu':function(_0x103322,_0x151fd6){return _0x103322<_0x151fd6;},'otUKU':function(_0x380012,_0x20547e){return _0x380012-_0x20547e;},'UMlpo':function(_0x2386e3,_0x3d0d09){return _0x2386e3<_0x3d0d09;}};for(let _0x33acdd=0x0;_0x54438b[_0x245cd3(0x1f3)](_0x33acdd,0x5);_0x33acdd++){const _0x250ea9=gameState[_0x245cd3(0x194)][_0x33acdd],_0x5a6188=Math['max'](0x0,_0x54438b[_0x245cd3(0x26c)](MAX_ROWS,_0x250ea9[_0x245cd3(0x1de)])),_0x1b99c5=Math[_0x245cd3(0x248)](_0xf8fd19,_0x5a6188);for(let _0x2f238c=0x0;_0x54438b[_0x245cd3(0x1d7)](_0x2f238c,_0x1b99c5);_0x2f238c++){_0x250ea9[_0x245cd3(0x24c)]({'char':'','trueTone':0x0});}}}function checkColumnForClear(_0xf2b02a){const _0xd3a7b9=a0_0x2fc661,_0x4b5c1f={'mspKG':function(_0x5d3646,_0x15780a){return _0x5d3646<_0x15780a;},'WalbM':function(_0x2f383f,_0x30f962){return _0x2f383f>_0x30f962;},'wwmff':function(_0x59eb5a,_0x31c7ce){return _0x59eb5a>=_0x31c7ce;},'ALUBy':function(_0x29e846,_0xcc9ec2){return _0x29e846===_0xcc9ec2;},'ONysM':function(_0x4c3cf2,_0x5d3cc){return _0x4c3cf2!==_0x5d3cc;},'Kyatb':function(_0x174c09,_0x55419c){return _0x174c09*_0x55419c;},'eSnhD':function(_0xd524e8,_0x50c436){return _0xd524e8<_0x50c436;},'bfeFa':function(_0x4be92f,_0x33d166){return _0x4be92f+_0x33d166;}},_0x4d24d0=gameState[_0xd3a7b9(0x194)][_0xf2b02a];if(_0x4b5c1f['mspKG'](_0x4d24d0['length'],0x5))return;let _0x345271=null,_0x1b14c8=0x0,_0x5d0da6=0x0;const _0x16712c=[];for(let _0x31dd3c=0x0;_0x31dd3c<_0x4d24d0[_0xd3a7b9(0x1de)];_0x31dd3c++){const _0x239297=_0x4d24d0[_0x31dd3c];if(!_0x239297[_0xd3a7b9(0x1e1)]||_0x239297[_0xd3a7b9(0x1e1)]<0x1||_0x4b5c1f['WalbM'](_0x239297[_0xd3a7b9(0x1e1)],0x5)){_0x4b5c1f[_0xd3a7b9(0x1e6)](_0x5d0da6,0x5)&&_0x16712c['push']({'start':_0x1b14c8,'len':_0x5d0da6,'tone':_0x345271});_0x345271=null,_0x5d0da6=0x0;continue;}_0x4b5c1f[_0xd3a7b9(0x1d9)](_0x345271,null)||_0x4b5c1f[_0xd3a7b9(0x290)](_0x239297[_0xd3a7b9(0x1e1)],_0x345271)?(_0x5d0da6>=0x5&&_0x16712c[_0xd3a7b9(0x24c)]({'start':_0x1b14c8,'len':_0x5d0da6,'tone':_0x345271}),_0x345271=_0x239297[_0xd3a7b9(0x1e1)],_0x1b14c8=_0x31dd3c,_0x5d0da6=0x1):_0x5d0da6++;}_0x4b5c1f[_0xd3a7b9(0x1e6)](_0x5d0da6,0x5)&&_0x16712c[_0xd3a7b9(0x24c)]({'start':_0x1b14c8,'len':_0x5d0da6,'tone':_0x345271});if(_0x16712c['length']===0x0)return;const _0x13d9e4=_0x16712c[0x0],_0x55825f=_0x4b5c1f['Kyatb'](_0x13d9e4[_0xd3a7b9(0x277)],0xa);gameState['score']+=_0x55825f,gameState[_0xd3a7b9(0x294)]+=0x1,updateScoreUI();const _0x992b72=[];for(let _0x1d7957=0x0;_0x4b5c1f[_0xd3a7b9(0x207)](_0x1d7957,_0x4d24d0[_0xd3a7b9(0x1de)]);_0x1d7957++){(_0x4b5c1f[_0xd3a7b9(0x1f5)](_0x1d7957,_0x13d9e4[_0xd3a7b9(0x1b0)])||_0x1d7957>=_0x4b5c1f['bfeFa'](_0x13d9e4[_0xd3a7b9(0x1b0)],_0x13d9e4[_0xd3a7b9(0x277)]))&&_0x992b72['push'](_0x4d24d0[_0x1d7957]);}gameState[_0xd3a7b9(0x194)][_0xf2b02a]=_0x992b72;}function finishGame(_0x51e842){const _0x191cad=a0_0x2fc661,_0x2d65d5={'BUybj':function(_0x1bdaba){return _0x1bdaba();},'qTHRE':function(_0x5c45c7,_0x35a0a5){return _0x5c45c7===_0x35a0a5;},'QvRXw':_0x191cad(0x22c),'CFHJL':function(_0x1f2996,_0x4e14b7){return _0x1f2996===_0x4e14b7;},'XRNxm':'block'};if(gameState[_0x191cad(0x265)])return;gameState[_0x191cad(0x265)]=!![],gameState[_0x191cad(0x291)]=![],_0x2d65d5[_0x191cad(0x1a8)](clearCharTimeout),_0x2d65d5['BUybj'](stopTimer);if(gameState['paused'])pauseTimer();gameState['paused']=![],pauseBtn[_0x191cad(0x22d)]=!![],_0x2d65d5[_0x191cad(0x1a8)](refreshPauseButtonText);const _0x1cb08d=TEXTS[currentLang];statusLabel[_0x191cad(0x1b9)]=_0x2d65d5[_0x191cad(0x1c2)](_0x51e842,_0x2d65d5['QvRXw'])?_0x1cb08d[_0x191cad(0x265)]:_0x1cb08d[_0x191cad(0x287)];_0x2d65d5[_0x191cad(0x1cc)](_0x51e842,_0x191cad(0x22c))?_0x2d65d5[_0x191cad(0x1a8)](showGameOverOverlay):hideGameOverOverlay();const _0x437963=gameState[_0x191cad(0x1ce)][_0x191cad(0x1d4)](0x1),_0x37d5a2=(gameState[_0x191cad(0x174)]||'')[_0x191cad(0x1c8)]();modalSummaryEl['textContent']=_0x37d5a2+'\x0a'+_0x1cb08d['score']+'\x20'+gameState[_0x191cad(0x1b1)]+'\x0a'+_0x1cb08d[_0x191cad(0x178)]+'\x20'+_0x437963+'s',playerNameInput[_0x191cad(0x1a4)]='',resultModal['style'][_0x191cad(0x205)]=_0x2d65d5[_0x191cad(0x211)];}function resizeCanvas(){const _0x35b7e7=a0_0x2fc661,_0x18b730={'YfxxD':_0x35b7e7(0x121),'TVxGe':function(_0x338138,_0x3c96f2){return _0x338138-_0x3c96f2;},'beaWq':function(_0x262dab,_0x18129b){return _0x262dab/_0x18129b;},'JAkqj':function(_0x5ea37f,_0x1fb7f6){return _0x5ea37f(_0x1fb7f6);}},_0x1c2086=0x2bc/0x1a4,_0x1d115f=document[_0x35b7e7(0x26e)](_0x18b730[_0x35b7e7(0x17c)]),_0x2b2596=_0x1d115f['clientWidth']||canvas[_0x35b7e7(0x21b)],_0x2bf759=Math[_0x35b7e7(0x249)](0x168,_0x18b730[_0x35b7e7(0x21d)](window[_0x35b7e7(0x1ca)],0xdc)),_0x5274ab=Math[_0x35b7e7(0x248)](_0x2b2596*_0x1c2086,_0x2bf759),_0x13ee7c=canvas[_0x35b7e7(0x228)]||_0x5274ab;canvas[_0x35b7e7(0x21b)]=Math[_0x35b7e7(0x156)](_0x2b2596),canvas[_0x35b7e7(0x228)]=Math[_0x35b7e7(0x156)](_0x5274ab);const _0x113df9=_0x18b730['beaWq'](canvas[_0x35b7e7(0x228)],_0x13ee7c);_0x113df9&&_0x18b730[_0x35b7e7(0x221)](isFinite,_0x113df9)&&gameState['fallingBlocks'][_0x35b7e7(0x15b)](_0x1d5523=>{_0x1d5523['y']*=_0x113df9;});}function drawBoard(){const _0x57a10f=a0_0x2fc661,_0x1408e8={'IbLIf':_0x57a10f(0x129),'vVGXR':function(_0x228c0b,_0x2fb2ef){return _0x228c0b*_0x2fb2ef;},'oguAQ':_0x57a10f(0x297),'stRTi':_0x57a10f(0x22f),'PDjbO':function(_0x4c7c79,_0x24f0ba){return _0x4c7c79/_0x24f0ba;},'ytjyJ':function(_0x38bd56,_0x259b84){return _0x38bd56+_0x259b84;},'Qxrnc':function(_0x1a7bde,_0xf75392){return _0x1a7bde/_0xf75392;},'FvCCm':function(_0x5e88ce,_0x533fb6){return _0x5e88ce/_0x533fb6;},'QBrbm':_0x57a10f(0x215),'LqYtw':function(_0x33d0a0,_0x50ad47){return _0x33d0a0<_0x50ad47;},'lrKgE':function(_0xbf4b7b,_0x56e7f7){return _0xbf4b7b*_0x56e7f7;},'ddacd':function(_0x15d545,_0x57febf){return _0x15d545*_0x57febf;},'yxUfx':function(_0x2b036b,_0x17df9b){return _0x2b036b-_0x17df9b;},'Bdeuv':function(_0x268226,_0x20678c){return _0x268226-_0x20678c;},'PEBfe':_0x57a10f(0x1e5),'PuHrj':function(_0x3d6ef9,_0x10d87a){return _0x3d6ef9+_0x10d87a;},'HXPfS':function(_0x27a320,_0x543492){return _0x27a320/_0x543492;},'dUbRF':function(_0x1028da,_0x21d2f5){return _0x1028da+_0x21d2f5;}},_0x51cbf2=canvas['width'],_0x1d27c8=canvas[_0x57a10f(0x228)];ctx[_0x57a10f(0x271)](0x0,0x0,_0x51cbf2,_0x1d27c8);const _0xee0c0c=_0x1408e8[_0x57a10f(0x251)](_0x51cbf2,0x5),_0x4aabb2=_0x1408e8['FvCCm'](_0x1d27c8,MAX_ROWS);ctx[_0x57a10f(0x17e)](),ctx['strokeStyle']=_0x1408e8[_0x57a10f(0x1bc)],ctx[_0x57a10f(0x14d)]=0x1;for(let _0x4d499f=0x0;_0x4d499f<0x5;_0x4d499f++){const _0x1069b5=_0x1408e8[_0x57a10f(0x1f1)](_0x4d499f,_0xee0c0c);ctx[_0x57a10f(0x153)](_0x1069b5,0x0,_0xee0c0c,_0x1d27c8);}ctx[_0x57a10f(0x192)]();for(let _0x4d9970=0x0;_0x1408e8['LqYtw'](_0x4d9970,0x5);_0x4d9970++){const _0x2609a1=gameState[_0x57a10f(0x194)][_0x4d9970];for(let _0x361cc2=0x0;_0x1408e8['LqYtw'](_0x361cc2,_0x2609a1[_0x57a10f(0x1de)]);_0x361cc2++){const _0x26006a=_0x2609a1[_0x361cc2],_0x3c1fb3=TONES[_0x57a10f(0x278)](_0x41f4cf=>_0x41f4cf[_0x57a10f(0x258)]===_0x26006a[_0x57a10f(0x1e1)]),_0x54edd1=_0x3c1fb3?_0x3c1fb3[_0x57a10f(0x23c)]:_0x57a10f(0x246),_0x5e891d=_0x1408e8[_0x57a10f(0x161)](_0x4d9970,_0xee0c0c),_0x2ebe24=_0x1408e8[_0x57a10f(0x28d)](_0x1408e8[_0x57a10f(0x1e8)](_0x1408e8[_0x57a10f(0x204)](MAX_ROWS,0x1),_0x361cc2),_0x4aabb2),_0x28203c=_0xee0c0c,_0x10b7c2=_0x4aabb2;ctx[_0x57a10f(0x149)]=_0x54edd1,ctx[_0x57a10f(0x180)](_0x5e891d,_0x2ebe24,_0x28203c,_0x10b7c2),ctx['strokeStyle']=_0x1408e8[_0x57a10f(0x273)],ctx[_0x57a10f(0x14d)]=0x1,ctx['strokeRect'](_0x5e891d,_0x2ebe24,_0x28203c,_0x10b7c2);if(_0x26006a['char']){const _0x4eb4e7=_0x1408e8[_0x57a10f(0x16d)][_0x57a10f(0x22e)]('|');let _0xf1a6dd=0x0;while(!![]){switch(_0x4eb4e7[_0xf1a6dd++]){case'0':ctx[_0x57a10f(0x20f)]=_0x57a10f(0x22f);continue;case'1':ctx[_0x57a10f(0x1a1)]=_0x1408e8[_0x57a10f(0x1df)];continue;case'2':ctx[_0x57a10f(0x224)](_0x26006a[_0x57a10f(0x1d0)],_0x1408e8[_0x57a10f(0x17b)](_0x5e891d,_0x1408e8[_0x57a10f(0x124)](_0x28203c,0x2)),_0x1408e8[_0x57a10f(0x24e)](_0x2ebe24,_0x1408e8[_0x57a10f(0x11f)](_0x10b7c2,0x2)));continue;case'3':ctx['font']=Math[_0x57a10f(0x1dd)](_0x1408e8[_0x57a10f(0x1f1)](_0x10b7c2,0.5))+_0x57a10f(0x14f);continue;case'4':ctx[_0x57a10f(0x149)]=_0x1408e8[_0x57a10f(0x273)];continue;}break;}}}}gameState[_0x57a10f(0x126)][_0x57a10f(0x15b)](_0x16ec7e=>{const _0x230d11=_0x57a10f,_0x10184e=_0x16ec7e[_0x230d11(0x24f)]*_0xee0c0c,_0x49cbe1=_0xee0c0c,_0x1d702d=_0x4aabb2;ctx[_0x230d11(0x149)]=FALLING_COLOR,ctx[_0x230d11(0x180)](_0x10184e,_0x16ec7e['y'],_0x49cbe1,_0x1d702d),ctx['strokeStyle']=_0x1408e8[_0x230d11(0x273)],ctx[_0x230d11(0x14d)]=0x1,ctx[_0x230d11(0x153)](_0x10184e,_0x16ec7e['y'],_0x49cbe1,_0x1d702d),ctx[_0x230d11(0x149)]=FALLING_TEXT_COLOR,ctx[_0x230d11(0x182)]=Math['floor'](_0x1408e8['vVGXR'](_0x1d702d,0.5))+_0x230d11(0x14f),ctx['textAlign']=_0x1408e8[_0x230d11(0x1df)],ctx[_0x230d11(0x20f)]=_0x1408e8['stRTi'],ctx['fillText'](_0x16ec7e[_0x230d11(0x1d0)],_0x10184e+_0x1408e8[_0x230d11(0x251)](_0x49cbe1,0x2),_0x1408e8[_0x230d11(0x254)](_0x16ec7e['y'],_0x1408e8[_0x230d11(0x25b)](_0x1d702d,0x2)));});}function animate(_0x403619){const _0x5c2759=a0_0x2fc661,_0xba9ee5={'ghtqv':function(_0x50b45e,_0x330cc5){return _0x50b45e*_0x330cc5;},'jQwpV':function(_0x588c8c,_0x524529){return _0x588c8c-_0x524529;},'CwOsa':function(_0x1288b6,_0x59ed03){return _0x1288b6>=_0x59ed03;},'KjVdy':function(_0x2f03f1,_0x1293ab){return _0x2f03f1(_0x1293ab);},'kIlTG':function(_0x2b9954,_0x4e6391){return _0x2b9954==_0x4e6391;},'GiEik':function(_0x59e514){return _0x59e514();},'DOyEN':function(_0x1e6a6a,_0xa4b898){return _0x1e6a6a(_0xa4b898);},'tLftL':function(_0x69bb69,_0xf86beb){return _0x69bb69/_0xf86beb;}};_0xba9ee5[_0x5c2759(0x1d1)](gameState[_0x5c2759(0x148)],null)&&(gameState[_0x5c2759(0x148)]=_0x403619);if(gameState[_0x5c2759(0x117)]||gameState[_0x5c2759(0x265)]){gameState['lastFrameTime']=_0x403619,_0xba9ee5[_0x5c2759(0x127)](drawBoard),_0xba9ee5[_0x5c2759(0x179)](requestAnimationFrame,animate);return;}const _0x17b57e=_0xba9ee5[_0x5c2759(0x13d)](_0x403619-gameState[_0x5c2759(0x148)],0x3e8);gameState[_0x5c2759(0x148)]=_0x403619;const _0x2d74e9=_0xba9ee5[_0x5c2759(0x13d)](canvas[_0x5c2759(0x228)],MAX_ROWS),_0x409030=[];gameState['fallingBlocks'][_0x5c2759(0x15b)](_0x1cbc22=>{const _0x4bf301=_0x5c2759,_0x47baad=_0xba9ee5['ghtqv'](_0xba9ee5['jQwpV'](_0xba9ee5[_0x4bf301(0x151)](MAX_ROWS,0x1),_0x1cbc22[_0x4bf301(0x1fc)]),_0x2d74e9);_0x1cbc22['y']+=_0xba9ee5[_0x4bf301(0x131)](FALL_SPEED,_0x17b57e),_0xba9ee5[_0x4bf301(0x280)](_0x1cbc22['y'],_0x47baad)?(_0x1cbc22['y']=_0x47baad,_0xba9ee5['KjVdy'](finalizeLanding,_0x1cbc22)):_0x409030[_0x4bf301(0x24c)](_0x1cbc22);}),gameState[_0x5c2759(0x126)]=_0x409030,_0xba9ee5[_0x5c2759(0x127)](drawBoard),_0xba9ee5[_0x5c2759(0x1e3)](requestAnimationFrame,animate);}function loadRecords(){const _0x9e125a=a0_0x2fc661;try{const _0x3b85dd=localStorage['getItem'](STORAGE_KEY);if(!_0x3b85dd)return{};return JSON[_0x9e125a(0x1cb)](_0x3b85dd);}catch{return{};}}function saveRecords(_0x3ca972){const _0x831113=a0_0x2fc661;try{localStorage['setItem'](STORAGE_KEY,JSON[_0x831113(0x208)](_0x3ca972));}catch{}}function addRecord(_0x412d9e,_0x26c1aa,_0x5922bc,_0x2138c7){const _0x5393cf=a0_0x2fc661,_0x275419={'iNawr':function(_0x3cec48,_0x56c808){return _0x3cec48-_0x56c808;},'jARBc':function(_0x4dd27e){return _0x4dd27e();}},_0x37c3af=_0x275419['jARBc'](loadRecords);if(!_0x37c3af[_0x412d9e])_0x37c3af[_0x412d9e]=[];_0x37c3af[_0x412d9e][_0x5393cf(0x24c)]({'name':_0x26c1aa,'score':_0x5922bc,'time':_0x2138c7,'date':new Date()[_0x5393cf(0x268)]()}),_0x37c3af[_0x412d9e][_0x5393cf(0x276)]((_0xf24e26,_0x228494)=>{const _0x1a8702=_0x5393cf;if(_0x228494[_0x1a8702(0x1b1)]!==_0xf24e26[_0x1a8702(0x1b1)])return _0x275419[_0x1a8702(0x125)](_0x228494[_0x1a8702(0x1b1)],_0xf24e26[_0x1a8702(0x1b1)]);return _0x275419[_0x1a8702(0x125)](_0xf24e26[_0x1a8702(0x178)],_0x228494[_0x1a8702(0x178)]);}),_0x37c3af[_0x412d9e]=_0x37c3af[_0x412d9e]['slice'](0x0,0xa),saveRecords(_0x37c3af);}function renderRecords(){const _0xd8e979=a0_0x2fc661,_0x55d359={'GSBcf':_0xd8e979(0x227),'Szbkg':function(_0x2c381a){return _0x2c381a();}},_0x468d93=_0x55d359[_0xd8e979(0x159)](loadRecords),_0x5ba8fb=gameState[_0xd8e979(0x174)],_0x187a44=_0x5ba8fb&&_0x468d93[_0x5ba8fb]?_0x468d93[_0x5ba8fb]:[];recordsListEl['innerHTML']='',_0x187a44[_0xd8e979(0x15b)]((_0x24aacd,_0x29abed)=>{const _0x160e85=_0xd8e979,_0x4584f2=document[_0x160e85(0x1d3)]('li');_0x4584f2['textContent']=_0x29abed+0x1+'.\x20'+(_0x24aacd[_0x160e85(0x162)]||_0x55d359['GSBcf'])+'\x20-\x20'+_0x24aacd[_0x160e85(0x1b1)]+_0x160e85(0x19b)+_0x24aacd['time'][_0x160e85(0x1d4)](0x1)+'s',recordsListEl['appendChild'](_0x4584f2);});}saveResultBtn[a0_0x2fc661(0x244)]('click',()=>{const _0x89459c=a0_0x2fc661,_0x4ae1a9={'iRXdY':function(_0x285849,_0x5c84f4,_0x2de27d,_0x34807f,_0x376932){return _0x285849(_0x5c84f4,_0x2de27d,_0x34807f,_0x376932);},'RFOMx':_0x89459c(0x260)},_0x490c18=playerNameInput['value'][_0x89459c(0x25f)]()||'Player',_0x44682f=gameState[_0x89459c(0x174)];_0x4ae1a9[_0x89459c(0x256)](addRecord,_0x44682f,_0x490c18,gameState['score'],gameState['lastElapsedSec']||0x0),resultModal['style'][_0x89459c(0x205)]=_0x4ae1a9[_0x89459c(0x225)],renderRecords();}),closeResultBtn['addEventListener'](a0_0x2fc661(0x267),()=>{const _0x1e263d=a0_0x2fc661;resultModal[_0x1e263d(0x1bb)][_0x1e263d(0x205)]=_0x1e263d(0x260);});function beginRun(){const _0x4eedec=a0_0x2fc661,_0x1a2c6c={'jFWCh':_0x4eedec(0x260),'TYwNO':function(_0x524979){return _0x524979();},'BPLqL':function(_0xa5c10a,_0x30fdd9){return _0xa5c10a(_0x30fdd9);}};if(!gameState[_0x4eedec(0x1ba)]||!gameState[_0x4eedec(0x174)])return;resultModal[_0x4eedec(0x1bb)][_0x4eedec(0x205)]='none',resetGameStateForCurrentDeck(),welcomePanel['style']['display']=_0x1a2c6c[_0x4eedec(0x252)],_0x1a2c6c[_0x4eedec(0x247)](startTimer),pauseBtn[_0x4eedec(0x22d)]=![],_0x1a2c6c[_0x4eedec(0x12a)](setHeaderRestartEnabled,!![]),_0x1a2c6c['BPLqL'](setPauseState,![]),_0x1a2c6c[_0x4eedec(0x247)](renderRecords),_0x1a2c6c[_0x4eedec(0x247)](updateSetupToggleLabel),_0x1a2c6c[_0x4eedec(0x247)](resizeCanvas),_0x1a2c6c[_0x4eedec(0x247)](nextPhrase);}function a0_0x30af(){const _0x478673=['BPLqL','deckLabel','phraseId','sfx/hit.mp3','audioUrl','auto','background','ghtqv','hit','进入游戏','tIiKu','firstChild','current-text-label','mpKxV','lang-btn','now','GXtQU','error','14buALDu','tLftL','sfx\x20failed','categories','zlBEE','random','4th\x20tone','deck-label','player-name','innerHTML','Snzpr','recordsTitle','lastFrameTime','fillStyle','AudioContext','sine','MhdoU','lineWidth','wcYPI','px\x20sans-serif','Current:','jQwpV','分数：','strokeRect','current','appendChild','round','manifest.json','当前：','Szbkg','nameLabel','forEach','3rd\x20tone','akCdo','level-label','connect','482634FruFrk','lrKgE','name','xHODL','aria-pressed','ClVqX','ubmmC','EAWeM','KGMjH','play','set','Load\x20dataset\x20failed:','STOKy','PEBfe','hyczS','some','status-label','langBtn','Choose\x20a\x20level\x20and\x20a\x20deck,\x20then\x20click\x20\x22Start\x22.\x0aUse\x20keys\x201–5\x20to\x20input\x20tones.\x0aWrong\x20input\x20creates\x20a\x20coloured\x20block\x20in\x20that\x20tone\x20column.\x0aIf\x20you\x20ignore\x20a\x20drop,\x20the\x20playfield\x20will\x20rise\x20a\x20few\x20rows\x20as\x20a\x20penalty\x20instead\x20of\x20piling\x20random\x20blocks.','MytEX','currentDeckId','toString','IkSJh','连击：','time','DOyEN','</div>\x0a\x20\x20\x20\x20','PuHrj','YfxxD','myhvD','save','IyfNO','fillRect','\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22tone-symbol\x22>','font','mSngq','FGAya','65735ljWaQx','match','429042lfWcqp','本局成绩','findIndex','QgSvO','Result','text','shift','PEKou','DXBzt','VNaVR','GilvF','restore','entries','board','YrGRz','#9254de','crossOrigin','NwVSJ','decksById','BBsjw','\x20pts,\x20','隐藏设置','VwivY','选择一个等级和词库，然后点击“开始游戏”。\x0a键盘\x201–5\x20输入声调。\x0a按错会在对应声调列生成彩色方块。\x0a如果放着不管，未输入的字会让底部整体升高几层作为惩罚。','change','replace','textAlign','setup-toggle','get','value','map','currentCharIndex','type','BUybj','join','setAttribute','PrCuQ','currentTime','nntCX','splice','currentPhraseId','start','score','showSetup','charIndex','16HruXWT','restart','className','WmQDH','chars','textContent','currentCategory','style','QBrbm','FCcLY','entry','Hide\x20setup','Time:','jsgoq','qTHRE','vAjCH','start-btn','Score:','button','neutral\x20tone','toUpperCase','IwSXA','innerHeight','parse','CFHJL','key','lastElapsedSec','welcome-text','char','kIlTG','nzgCC','createElement','toFixed','437032opstVe','welcome-panel','UMlpo','restart-btn','ALUBy','createGain','audio','pop','floor','length','oguAQ','qHNiD','trueTone','warn','KjVdy','DsvNx','4|3|1|0|2','wwmff','pause-btn','yxUfx','UzfFf','ilhhx','game-over-text','Click\x20below\x20to\x20enter\x20the\x20game,\x20then\x20choose\x20level\x20and\x20deck.','GLbdL','\x20\x20|\x20\x20⌨️\x20','Level:','189576qrZHjE','vVGXR','已加载等级：','bEfgu','false','eSnhD','ready','NPCYE','0|1|3|2|4','deck-select','SSmfQ','option','targetRowIndex','（无）','jrJHM','records-title','KlsUn','BADcw','flex','lDUVW','Bdeuv','display','arxhD','mspKG','stringify','Show\x20setup','levelLabel','currentPhrase','cloneNode','querySelector','English','textBaseline','FpfpL','XRNxm','game-canvas','displayName','bwEry','#333','colIndex','UlFvv','Paused','#timer','save-result-btn','width','getContext','TVxGe','oJJUc','status','symbol','JAkqj','game-over-overlay','block','fillText','RFOMx','message','Player','height','playSfx\x20failed','destination','shtPh','over','disabled','split','middle','Deck:','rqTCp','elapsedBaseSec','keys','Game\x20Over!','clMcm','modal-summary','Failed\x20to\x20load\x20','webkitAudioContext','peftW','lIXXH','Combo:','color','audioObj','#fadb14','hyHza','preload','#73d13d','NSKMY','#40a9ff','addEventListener','\x0a以下文件加载失败（忽略）：\x0a','#3a3e49','TYwNO','min','max','用时：','选择词库：','push','点击下面的按钮进入游戏，然后先选择等级，再选择词库开始练习。','dUbRF','colIdx','level-select','PDjbO','jFWCh','Unwzu','ytjyJ','charTimeoutHandle','iRXdY','AmlXG','tone','close','answered','Qxrnc','nvmaQ','nsSiz','uvRtr','trim','none','stop','timerHandle','Enter\x20Game','保存成绩','gameOver','HxADy','click','toISOString','kQyAL','result-modal','resume','otUKU','1st\x20tone','getElementById','plyKw','records-list','clearRect','HSfxH','IbLIf','YyZED','SVAey','sort','len','find','DwBAb','xJIYo','116748QIBoUg','开始游戏','combo-label','sfx/miss.mp3','XjLpT','CwOsa','UhRXR','target','当前词库成绩','score-label','fqDBU','3|1|0|2|5|4','gameClear','tone-buttons','audio\x20play\x20failed','lsVlK','slice','jBLfJ','ddacd','请输入名字：','EnCSl','ONysM','awaitingInput','tRADC','createOscillator','combo','lastNoInputColumnIdx','234962AnGMNo','center','json','uCbfk','选择等级：','MunLL','startTime','paused','Leaderboard\x20for\x20this\x20deck','&nbsp;','sqEsX','title','HjdSa','true','has','FvCCm','NRPQU','canvas-container','pause','SAJgD','HXPfS','iNawr','fallingBlocks','GiEik','Restart','#000'];a0_0x30af=function(){return _0x478673;};return a0_0x30af();}startBtn[a0_0x2fc661(0x244)](a0_0x2fc661(0x267),()=>{const _0x19f1fd=a0_0x2fc661,_0x1bab99={'nvmaQ':function(_0x125a62,_0x1b2b31){return _0x125a62||_0x1b2b31;},'KGMjH':function(_0x175918){return _0x175918();}},_0x339b6f=levelSelect[_0x19f1fd(0x1a4)],_0x59a943=deckSelect['value'];if(_0x1bab99[_0x19f1fd(0x25c)](!_0x339b6f,!_0x59a943))return;gameState['currentCategory']=_0x339b6f,gameState[_0x19f1fd(0x174)]=_0x59a943,_0x1bab99[_0x19f1fd(0x168)](beginRun);}),restartBtn[a0_0x2fc661(0x244)](a0_0x2fc661(0x267),beginRun),headerRestartBtn[a0_0x2fc661(0x244)](a0_0x2fc661(0x267),beginRun),levelSelect[a0_0x2fc661(0x244)](a0_0x2fc661(0x19f),_0x43598a=>{const _0x4bd481=a0_0x2fc661,_0x361a74={'YrGRz':function(_0x2eb991,_0x19ebd8){return _0x2eb991(_0x19ebd8);},'NRPQU':function(_0x594d9b){return _0x594d9b();}},_0x4203e5=_0x43598a[_0x4bd481(0x282)][_0x4bd481(0x1a4)];gameState[_0x4bd481(0x1ba)]=_0x4203e5,_0x361a74[_0x4bd481(0x195)](populateDeckSelectForCategory,_0x4203e5),_0x361a74[_0x4bd481(0x120)](renderRecords);}),deckSelect['addEventListener'](a0_0x2fc661(0x19f),_0x5c2ad0=>{const _0x337a37=a0_0x2fc661;gameState['currentDeckId']=_0x5c2ad0[_0x337a37(0x282)]['value'],renderRecords();}),window['addEventListener']('resize',()=>{const _0x54baa9=a0_0x2fc661,_0x5a7b27={'VNaVR':function(_0x18268d){return _0x18268d();}};resizeCanvas(),_0x5a7b27[_0x54baa9(0x190)](drawBoard);}),window['addEventListener']('keydown',_0x1284ba=>{const _0x5d973a=a0_0x2fc661,_0x321e8f={'lIXXH':function(_0x5cc84,_0x347a9c,_0x4f1ee2){return _0x5cc84(_0x347a9c,_0x4f1ee2);},'lDUVW':function(_0x20a47c,_0x43cfd1){return _0x20a47c>=_0x43cfd1;},'tIiKu':function(_0xe3819,_0x3adda6){return _0xe3819(_0x3adda6);}},_0x48d7ba=_0x321e8f[_0x5d973a(0x23a)](parseInt,_0x1284ba[_0x5d973a(0x1cd)],0xa);if(_0x321e8f[_0x5d973a(0x203)](_0x48d7ba,0x1)&&_0x48d7ba<=0x5)_0x321e8f[_0x5d973a(0x134)](handleToneInput,_0x48d7ba);}),async function init(){const _0x520fb7=a0_0x2fc661,_0xbdb72d={'nntCX':function(_0x11d3fb){return _0x11d3fb();},'PEKou':function(_0x26619d){return _0x26619d();},'ThYLj':function(_0xa42e01,_0x515cd7){return _0xa42e01(_0x515cd7);}};try{const _0x446c92=_0x520fb7(0x286)[_0x520fb7(0x22e)]('|');let _0x5bb615=0x0;while(!![]){switch(_0x446c92[_0x5bb615++]){case'0':_0xbdb72d[_0x520fb7(0x1ad)](updateLanguageUI);continue;case'1':_0xbdb72d['nntCX'](preloadSfx);continue;case'2':_0xbdb72d[_0x520fb7(0x18e)](resizeCanvas);continue;case'3':await loadAllDatasets();continue;case'4':_0xbdb72d['ThYLj'](requestAnimationFrame,animate);continue;case'5':drawBoard();continue;}break;}}catch(_0x4ac326){console[_0x520fb7(0x13b)](_0x4ac326),infoDiv['textContent']='加载数据失败：'+_0x4ac326[_0x520fb7(0x226)];}}();